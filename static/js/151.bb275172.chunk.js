(self.webpackChunkmy_calculator=self.webpackChunkmy_calculator||[]).push([[151],{708:(e,r,t)=>{if("undefined"===typeof i){var i=t(417);t(778)}!function(){"use strict";var e=i.getCore(),r=e.PARSER,t=e.Frac,n=e.Settings,a=e.Utils.isSymbol,s=e.groups.FN,o=e.Symbol,l=e.Utils.text,u=e.Utils.inBrackets,p=e.Utils.isInt,f=e.Utils.format,c=e.Utils.even,m=e.Utils.evaluate,g=e.groups.N,h=e.groups.S,v=(s=e.groups.FN,e.groups.PL),d=e.groups.CP,w=e.groups.CB,y=e.groups.EX,b=e.groups.P,S=n.LOG,q="abs",U="sqrt",M="sin",x="cos",L="tan",k="sec",C="csc",N="cot",_="asin",F="acos",T="atan",A="asec",E="acsc",I="acot",D="sinh",P="cosh",R="tanh",V="csch",O="sech",G="coth",z="asech",B="acsch",j="acoth";function H(e){this.message=e||""}H.prototype=new Error,o.prototype.hasIntegral=function(){return this.containsFunction("integrate")},o.prototype.fnTransform=function(){if(this.group!==s)return this;var e,t=this.args[0],i=new o(this.multiplier),n=this.clone().toUnitMultiplier();if(this.isLinear())switch(this.fname){case D:e=r.parse(f("(e^({0})-e^(-({0})))/2",t));break;case P:e=r.parse(f("(e^({0})+e^(-({0})))/2",t));break;case R:e=r.parse(f("(e^({0})-e^(-({0})))/(e^({0})+e^(-({0})))",t));break;case L:e=r.parse(f("sin({0})/cos({0})",t));break;case C:e=r.parse(f("1/sin({0})",t));break;case k:e=r.parse(f("1/cos({0})",t));break;default:e=n}else if(this.power.equals(2))switch(this.fname){case M:e=r.parse(f("1/2-cos(2*({0}))/2",t));break;case x:e=r.parse(f("1/2+cos(2*({0}))/2",t));break;case L:e=r.parse(f("sin({0})^2/cos({0})^2",t));break;case P:e=r.parse(f("1/2+cosh(2*({0}))/2",t));break;case D:e=r.parse(f("-1/2+cosh(2*({0}))/2",t));break;case R:e=r.parse(f("(1+cosh(2*({0})))/(-1+cosh(2*({0})))",t));break;case k:e=r.parse(f("(1-cos(2*({0})))/(1+cos(2*({0})))+1",t));break;default:e=n}else if(this.fname===k)e=r.parse(f("1/cos({0})^({1})",this.args[0],this.power));else if(this.fname===C)e=r.parse(f("1/sin({0})^({1})",this.args[0],this.power));else if(this.fname===L)e=this.power.lessThan(0)?r.parse(f("cos({0})^(-({1}))/sin({0})^({1})",this.args[0],this.power.negate())):r.parse(f("sin({0})^({1})/cos({0})^({1})",this.args[0],this.power));else if(this.fname===M&&this.power.lessThan(0))e=r.parse(f("csc({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===x&&this.power.lessThan(0))e=r.parse(f("sec({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===M&&this.power.equals(3))e=r.parse(f("(3*sin({0})-sin(3*({0})))/4",this.args[0]));else if(this.fname===x&&this.power.equals(3))e=r.parse(f("(cos(3*({0}))+3*cos({0}))/4",this.args[0]));else if(this.fname!==x&&this.fname!==M||!c(this.power))e=n;else{var a=this.power/2,l=r.pow(this.clone().toLinear(),r.parse(2)).fnTransform(),u=r.expand(r.pow(l,r.parse(a)));e=new o(0),u.each(function(t){var i=t.fnTransform();e=r.add(e,i)},!0)}return r.multiply(e,i)},o.prototype.hasTrig=function(){if(this.isConstant(!0)||this.group===h)return!1;if(this.fname&&(e.Utils.in_trig(this.fname)||e.Utils.in_inverse_trig(this.fname)))return!0;if(this.symbols)for(var r in this.symbols)if(this.symbols[r].hasTrig())return!0;return!1},e.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()},e.Utils.toCommonDenominator=function(t){if(t.isComposite()&&t.isLinear()){var i=new o(t.multiplier),n=new o(1),a=new o(0);return t.each(function(e){n=r.multiply(n,e.getDenom())},!0),t.each(function(e){var t=e.getNum(),i=e.getDenom(),s=r.multiply(t,r.divide(n.clone(),i));a=r.add(a,s)}),r.multiply(i,e.Algebra.divide(r.expand(a),r.expand(n)))}return t},e.Utils.in_inverse_trig=function(e){return-1!==[_,F,T,E,A,I].indexOf(e)},e.Utils.in_trig=function(e){return-1!==[x,M,L,k,C,N].indexOf(e)},e.Utils.in_htrig=function(e){return-1!==[D,P,R,B,z,j].indexOf(e)},e.Matrix.jacobian=function(r,t){var i=new e.Matrix;return t||(t=e.Utils.arrayGetVariables(r)),t.forEach(function(t,n){r.forEach(function(r,a){var s=e.Calculus.diff(r.clone(),t);i.set(a,n,s)})}),i},e.Matrix.prototype.max=function(){var e=new o(0);return this.each(function(r){var t=r.abs();t.gt(e)&&(e=t)}),e},e.Matrix.cMatrix=function(t,i){var n=new e.Matrix;return i.forEach(function(e,i){n.set(i,0,r.parse(t))}),n};var Q=e.Utils.all_functions=function(e){for(var r=0,t=e.length;r<t;r++)if(e[r].group!==s)return!1;return!0},Z=e.Utils.cosAsinBtranform=function(e,t){var i,n;return i=e.args[0],n=t.args[0],r.parse(f("(sin(({0})+({1}))-sin(({0})-({1})))/2",i,n))},X=e.Utils.cosAsinAtranform=function(e,t){return 1!==Number(t.power)?r.multiply(e,t):(i=e.args[0],r.parse(f("(sin(2*({0})))/2",i)));var i},Y=e.Utils.cosAsinBtranform=function(e,t){var i,n;return i=e.args[0],n=t.args[0],r.parse(f("(cos(({0})+({1}))-cos(({0})-({1})))/2",i,n))},J=e.Utils.trigTransform=function(e){for(var t,i,n={},a=new o(1),l=0,u=e.length;l<u;l++)if((t=e[l]).group===s){var p=t.fname;p===x&&n[M]?(i=n[M].args[0].toString()!==t.args[0].toString()?Z(t,n[M]):X(t,n[M]),delete n[M],a=r.multiply(a,i)):p===M&&n[x]?(i=n[x].args[0].toString()!==t.args[0].toString()?Z(t,n[x]):X(t,n[x]),delete n[x],a=r.multiply(a,i)):p===M&&n[M]?(n[M].args[0].toString()!==t.args[0].toString()?(i=Y(t,n[M]),delete n[M]):(i=r.multiply(t,n[M]),delete n[M]),a=i):n[p]=t}else a=r.multiply(a,t);for(var f in n)a=r.multiply(a,n[f]);return a};e.Settings.integration_depth=10,e.Settings.max_lim_depth=10;var K=e.Calculus={version:"1.4.6",sum:function(t,i,n,a){if(i.group!==e.groups.S)throw new e.exceptions.NerdamerTypeError("Index must be symbol. "+l(i)+" provided");var s;if(i=i.value,e.Utils.isNumericSymbol(n)&&e.Utils.isNumericSymbol(a)){var u=a-n<200?"":"PARSE2NUMBER";n=Number(n),a=Number(a),s=e.Utils.block(u,function(){for(var s=t.text(),l={"~":!0},u=new e.Symbol(0),p=n;p<=a;p++){l[i]=new o(p);var f=r.parse(s,l);u=r.add(u,f)}return u})}else s=r.symfunction("sum",arguments);return s},product:function(t,i,n,a){if(i.group!==e.groups.S)throw new e.exceptions.NerdamerTypeError("Index must be symbol. "+l(i)+" provided");var s;if(i=i.value,e.Utils.isNumericSymbol(n)&&e.Utils.isNumericSymbol(a)){var u=a-n<200?"":"PARSE2NUMBER";s=e.Utils.block(u,function(){n=Number(n),a=Number(a.multiplier);for(var s=t.text(),l={},u=new e.Symbol(1),p=n;p<=a;p++)l[i]=new o(p),u=r.multiply(u,r.parse(s,l));return u})}else s=r.symfunction("product",arguments);return s},diff:function(i,p,c){if(e.Utils.isVector(i)){var m=new e.Vector([]);return i.each(function(e){m.elements.push(K.diff(e,p,c))}),m}if(e.Utils.isMatrix(i)){var D=new e.Matrix;return i.each(function(e,r,t){D.set(r,t,K.diff(e,p,c))}),D}var P=a(p)?p.text():p;if(c=a(c)?c.multiplier:c||1,void 0===P&&(P=e.Utils.variables(i)[0]),i.group===s&&i.fname===U){var H=i.args[0],Q=i.power.clone();H.group===g&&H.group===b||(H.power=a(H.power)?r.multiply(H.power,r.multiply(new o(.5)),Q):H.power.multiply(new t(.5)).multiply(Q),H.multiplier=H.multiplier.multiply(i.multiplier)),i=H}if(i.group!==s||a(i.power))i=J(i);else{var Z=J(r.parse(i)),X=K.diff(i.args[0].clone(),P);i=r.multiply(Z,X)}return c>1&&(c--,i=K.diff(i,p,c)),i;function Y(e){return(e.value===P||e.contains(P,!0))&&(e.multiplier=e.multiplier.multiply(e.power),e.power=e.power.subtract(new t(1)),e.power.equals(0)&&(e=o(e.multiplier))),e}function J(e){var i,c,m=e.group;if(m===g||m===h&&e.value!==P||m===b)e=o(0);else if(m===h)e=Y(e);else{if(m===w){var U=e.multiplier.clone();e.toUnitMultiplier();var D=r.multiply(function(e){for(var t=e.collectSymbols(),i=new o(0),n=t.length,a=0;a<n;a++){for(var s=K.diff(t[a].clone(),P),l=0;l<n;l++)a!==l&&(s=r.multiply(s,t[l].clone()));i=r.add(i,s)}return i}(e),Y(e));return D.multiplier=D.multiplier.multiply(U),D}if(m===s&&e.power.equals(1))switch(e.fname){case S:c=e.clone(),(e=e.args[0].clone()).power=e.power.negate(),e.multiplier=c.multiplier.divide(e.multiplier);break;case x:e.fname=M,e.multiplier.negate();break;case M:e.fname=x;break;case L:e.fname=k,e.power=new t(2);break;case k:e=W(e,L);break;case C:e=W(e,"-cot");break;case N:e.fname=C,e.multiplier.negate(),e.power=new t(2);break;case _:e=r.parse("(sqrt(1-("+l(e.args[0])+")^2))^(-1)");break;case F:e=r.parse("-(sqrt(1-("+l(e.args[0])+")^2))^(-1)");break;case T:e=r.parse("(1+("+l(e.args[0])+")^2)^(-1)");break;case q:U=e.multiplier.clone(),e.toUnitMultiplier(),(i=e.args[0].clone()).toUnitMultiplier(),(e=r.parse(u(l(e.args[0]))+"/abs"+u(l(i)))).multiplier=U;break;case"parens":e=o(1);break;case"cosh":e.fname="sinh";break;case"sinh":e.fname="cosh";break;case R:e.fname=O,e.power=new t(2);break;case O:e=W(e,"-tanh");break;case V:var H=String(e.args[0]);return r.parse("-coth("+H+")*csch("+H+")");case G:H=String(e.args[0]);return r.parse("-csch("+H+")^2");case"asinh":e=r.parse("(sqrt(1+("+l(e.args[0])+")^2))^(-1)");break;case"acosh":e=r.parse("(sqrt(-1+("+l(e.args[0])+")^2))^(-1)");break;case"atanh":e=r.parse("(1-("+l(e.args[0])+")^2)^(-1)");break;case z:H=String(e.args[0]);e=r.parse("-1/(sqrt(1/("+H+")^2-1)*("+H+")^2)");break;case j:e=r.parse("-1/(("+e.args[0]+")^2-1)");break;case B:H=String(e.args[0]);e=r.parse("-1/(sqrt(1/("+H+")^2+1)*("+H+")^2)");break;case A:H=String(e.args[0]);e=r.parse("1/(sqrt(1-1/("+H+")^2)*("+H+")^2)");break;case E:H=String(e.args[0]);e=r.parse("-1/(sqrt(1-1/("+H+")^2)*("+H+")^2)");break;case I:e=r.parse("-1/(("+e.args[0]+")^2+1)");break;case"S":H=String(e.args[0]);e=r.parse("sin((pi*("+H+")^2)/2)");break;case"C":H=String(e.args[0]);e=r.parse("cos((pi*("+H+")^2)/2)");break;case"Si":H=e.args[0];e=r.parse("sin("+H+")/("+H+")");break;case"Shi":H=e.args[0];e=r.parse("sinh("+H+")/("+H+")");break;case"Ci":H=e.args[0];e=r.parse("cos("+H+")/("+H+")");break;case"Chi":H=e.args[0];e=r.parse("cosh("+H+")/("+H+")");break;case"Ei":H=e.args[0];e=r.parse("e^("+H+")/("+H+")");break;case"Li":H=e.args[0];e=r.parse("1/"+n.LOG+"("+H+")");break;case"erf":e=r.parse("(2*e^(-("+e.args[0]+")^2))/sqrt(pi)");break;case"atan2":var Q=String(e.args[0]),Z=String(e.args[1]);e=r.parse("("+Z+")/(("+Z+")^2+("+Q+")^2)");break;case"sign":e=new o(0);break;case"sinc":e=r.parse(f("(({0})*cos({0})-sin({0}))*({0})^(-2)",e.args[0]));break;case n.LOG10:e=r.parse("1/(("+e.args[0]+")*"+n.LOG+"(10))");break;default:e=r.symfunction("diff",[e,p])}else if(m===y||m===s&&a(e.power)){var X;X=m===y?e.value:m===s&&e.contains(P)?e.fname+u(l(e.args[0])):e.value+u(l(e.args[0])),r.multiply(r.parse(S+u(X)),e.power.clone()),i=K.diff(r.multiply(r.parse(S+u(X)),e.power.clone()),P),e=r.multiply(e,i)}else if(m!==s||e.power.equals(1)){if(m===d||m===v){var $=e.clone(),ee=new o(0);for(var re in e.symbols)ee=r.add(ee,K.diff(e.symbols[re].clone(),P));e=r.multiply(Y($),ee)}}else(i=e.clone()).toLinear(),i.toUnitMultiplier(),e=r.multiply(Y(e.clone()),J(i))}return e.updateHash(),e}function W(e,t,i){return r.multiply(e,r.parse(t+u(i||l(e.args[0]))))}},integration:{u_substitution:function(t,i){function n(e,t,n){var a=K.diff(t,i),s=n?n(e,t):r.divide(e.clone(),a);return s.contains(i,!0)?null:s}function a(e,t){var i=K.integrate(r.symfunction(e,[new o(m)]),m,0);return(i=i.sub(new o(m),t)).updateHash(),i}var l,u=t[0].clone(),p=t[1].clone(),f=u.group,c=p.group,m="__u__";if(f===s&&c!==s){if(l=n(p,(g=u.args[0]).clone()))return r.multiply(l,a(u.fname,g));if(l=n(p,u))return K.integration.poly_integrate(u)}else if(c===s&&f!==s){var g;if(l=n(u,(g=p.args[0]).clone()))return r.multiply(l,a(p.fname,g))}else if(f===s&&c===s){if(l=n(u.clone(),p.clone()))return r.multiply(K.integration.poly_integrate(p),l);if(l=n(p.clone(),u.clone()))return r.multiply(K.integration.poly_integrate(p),l)}else{if(f===y&&c!==y){if(!(l=n(p,(q=u.power).clone()))){var h=K.integration.decompose_arg(q.clone(),i),v=K.diff(h[2].clone(),i),d=K.integration.decompose_arg(v.clone(),i);if(r.multiply(h[1],d[1]).power.equals(p.power)){var w=r.divide(h[0].clone(),d[0].clone()),b=r.multiply(w.clone(),r.pow(new o(u.value),r.multiply(h[0],new o(m))));return b=r.multiply(b,new o(m)),K.integration.by_parts(b,m,0,{}).sub(m,h[1].clone())}}var S=K.integrate(u.sub(q.clone(),new o(m)),m,0);return r.multiply(S.sub(new o(m),q),l)}if(c===y&&f!==y){var q;l=n(u,(q=p.power).clone());S=K.integrate(p.sub(q,new o(m)),m,0);return r.multiply(S.sub(new o(m),q),l)}if(u.isComposite()||p.isComposite()){var U=function(t,n){var a=K.diff(n,i),s=e.Algebra.Factor.factor(t),o=e.Algebra.Factor.factor(a);return r.divide(s,o)},M=u.isComposite()?u.clone().toLinear():u.clone(),x=p.isComposite()?p.clone().toLinear():p.clone();if(l=n(M.clone(),x.clone(),U))return r.multiply(K.integration.poly_integrate(p),l);if(l=n(x.clone(),M.clone(),U))return r.multiply(K.integration.poly_integrate(u),l)}}},poly_integrate:function(e){var t=e.power.toString(),i=e.multiplier.toDecimal(),n=e.toUnitMultiplier().toLinear();return-1===Number(t)?r.multiply(new o(i),r.symfunction(S,[n])):r.parse(f("({0})*({1})^(({2})+1)/(({2})+1)",i,n,t))},stop:function(r){throw r=r||"Unable to compute integral!",e.Utils.warn(r),new H(r)},partial_fraction:function(t,i,n,s){var l,u;return a(i)||(i=r.parse(i)),l=new o(0),(u=e.Algebra.PartFrac.partfrac(t,i)).group===w&&u.isLinear()?(u.each(function(e){e.isLinear()||K.integration.stop()}),u.each(function(e){l=r.add(l,K.integrate(e,i,n,s))})):l=r.add(l,K.integrate(u,i,n,s)),l},get_udv:function(t){var i=[[],[],[],[],[]],n=function(r){var t=r.group;if(t===s){var n=r.fname;e.Utils.in_trig(n)||e.Utils.in_htrig(n)?i[3].push(r):e.Utils.in_inverse_trig(n)?i[1].push(r):n===S?i[0].push(r):K.integration.stop()}else t===h||r.isComposite()&&r.isLinear()||t===w&&r.isLinear()?i[2].push(r):t===y||r.isComposite()&&!r.isLinear()?i[4].push(r):K.integration.stop()};t.group===w?t.each(function(e){n(o.unwrapSQRT(e,!0))}):n(t);for(var a,l=new o(1),u=0;u<5;u++){var p,f=i[u],c=f.length;if(c>0){if(c>1){p=new o(1);for(var m=0;m<c;m++)p=r.multiply(p,f[m].clone())}else p=f[0].clone();a?l=r.multiply(l,p):(a=p).multiplier=a.multiplier.multiply(t.multiplier)}}return[a,l]},trig_sub:function(t,i,n,a,s,o){(s=s||K.integration.decompose_arg(t.clone().toLinear(),i))[3],s[2];var l=s[0],p=s[1];if(p.power.equals(2)&&l.greaterThan(0)){var f=e.Utils.getU(t),c=r.parse(L+u(f)),m=r.parse(k+u(f)+"^2"),g=r.multiply(t.sub(p,c),m),h=K.integrate(g,f,n,a).sub(c,p);return e.Utils.clearU(c),h}},by_parts:function(t,i,n,a){var s,l,u,p,f,c,m,g,h,v,d,w;if(a.previous=a.previous||[],l=(s=K.integration.get_udv(t))[0],u=s[1],d=(p=o.unwrapSQRT(r.expand(K.diff(l.clone(),i)),!0)).clone().stripVar(i),p=r.divide(p,d.clone()),f=K.integrate(u.clone(),i,n||0),w=(c=r.multiply(f.clone(),p)).toString(),-1!==a.previous.indexOf(w)&&e.Utils.in_trig(l.fname)&&u.isE())return a.is_cyclic=!0,new o(1);if(a.previous.push(w),m=r.multiply(l,f),v=c.multiplier.clone(),c.toUnitMultiplier(),(h=r.multiply(K.integrate(c.clone(),i,n,a),d)).multiplier=h.multiplier.multiply(v),g=r.subtract(m,h),a.is_cyclic&&(a.previous.pop(),0===a.previous.length)){g=r.expand(g);var y=new o(0);g.each(function(e){e.contains(i)||(y=r.add(y,e.clone()))}),g=r.divide(r.subtract(g,y.clone()),r.subtract(new o(1),y))}return g},decompose_arg:e.Utils.decompose_fn},integrate:function(i,l,m,g){if(!l){var b=e.Utils.variables(i);1===b.length&&(l=b[0]),l=l||"x"}if(e.Utils.isVector(i)){var Z=new e.Vector([]);return i.each(function(e){Z.elements.push(K.integrate(e,l))}),Z}return isNaN(l)||r.error("variable expected but received "+l),i.isConstant(!0)?r.multiply(i.clone(),r.parse(l)):(g=g||{},e.Utils.block("PARSE2NUMBER",function(){m=m||0;var b,Z=a(l)?l.toString():l,X=o.unwrapSQRT(i.clone(),!0),Y=X.group;try{if(++m>e.Settings.integration_depth&&K.integration.stop("Maximum depth reached. Exiting!"),X.contains(Z,!0)){if(Y===h)b=K.integration.poly_integrate(X,Z,m);else if(Y===y)if(X.previousGroup===s&&"sqrt"!==X.fname&&X.fname!==n.PARENTHESIS&&K.integration.stop(),X.contains(Z)&&X.previousGroup!==s){if(X.power.contains(Z))K.integration.stop();else(Ye=K.diff(X.clone().toLinear(),Z)).contains(Z)&&K.integration.stop(),b=K.integration.poly_integrate(X,Z,m)}else{if((ae=K.diff(X.power.clone(),Z)).contains(Z)){var W=ae.stripVar(Z);if((se=r.divide(ae.clone(),W.clone())).group===h&&se.isLinear())return W.multiplier=W.multiplier.divide(new t(2)),r.parse(f("({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))",W,Z,X.multiplier));K.integration.stop()}if(X.isE())ae.isLinear()?b=X:ae.isE()&&ae.power.group===h&&ae.power.power.equals(1)?b=r.multiply(r.symfunction("Ei",[X.power.clone()]),X.power):K.integration.stop();else{var $=r.symfunction(S,[r.parse(X.value)]);b=r.divide(X,$)}b=r.divide(b,ae)}else if(X.isComposite()&&X.isLinear()){var ee=r.parse(X.multiplier);X.toUnitMultiplier(),b=new o(0),X.each(function(e){b=r.add(b,K.integrate(e,Z,m))}),b=r.multiply(ee,b)}else if(Y===d)if(X.power.greaterThan(1)&&(X=r.expand(X)),X.power.equals(1))b=new o(0),X.each(function(e){b=r.add(b,K.integrate(e,Z,m))},!0);else{var re=Number(X.power);ee=X.multiplier.clone();X.toUnitMultiplier();var te=X.clone().toLinear(),ie=(Er=K.integration.decompose_arg(te,Z))[3],ne=Er[2],ae=Er[0],se=Er[1];if(-1===re&&se.group!==v&&se.power.equals(2)){var oe=!p(ie)||ie>0;if(se.group===h&&se.power.equals(2)&&oe){var le=function(e){var t=new o(1);return e.each(function(e){t=r.multiply(t,"abs"===e.fname?e.args[0]:e)}),t},ue=ae.clone(),pe=ie.clone();ue=r.pow(ue,new o(.5)),pe=r.pow(pe,new o(.5));$=r.multiply(le(pe),le(ue));var fe=r.symfunction(T,[r.divide(r.multiply(ae,se.toLinear()),$.clone())]);b=r.divide(fe,$)}else if(se.group===h&&se.isLinear())b=r.divide(K.integration.poly_integrate(X),ae);else if(se.power.equals(4)){var ce,me,ge,he,ve,de,we=u;ue=r.parse(U+we(ae)+"*"+Z+"^2"),pe=r.parse(U+we(2)+"*"+we(ae)+"^"+we("1/4")+"*"+we(ie)+"^"+we("1/4")+"*"+Z),ce=r.parse(U+we(ie)),Fe=r.add(r.add(ue.clone(),pe.clone()),ce.clone()),er=r.add(r.subtract(ue,pe),ce),me=r.parse(U+we(2)+"*"+we(ie)+"^"+we("3/4")),ge=r.parse(U+we(ie)+"*"+we(ie)+"^"+we("1/4")+"*"+Z),he=r.parse("2*"+we(ie)+"*"+U+we(2)+"*"+we(ie)+"^"+we("1/4")),ve=r.divide(r.subtract(me.clone(),ge.clone()),r.multiply(he.clone(),er)),de=r.divide(r.add(me,ge),r.multiply(he,Fe.clone())),b=r.add(K.integrate(ve,Z,m,g),K.integrate(de,Z,m,g))}else b=K.integration.partial_fraction(X,Z,m)}else if(-.5===re)if(se.group===h&&se.power.equals(2))if(ne.multiplier.lessThan(0)&&!ie.multiplier.lessThan(0))if(ae.negate(),ie.isConstant()&&ae.isConstant()){$=r.symfunction(U,[ae.clone()]);var ye=r.symfunction(U,[r.multiply(ae.clone(),ie)]);b=r.divide(r.symfunction(_,[r.divide(ne.toLinear(),ye)]),$)}else{var be=r.symfunction(U,[ae]),Se=r.multiply(be.clone(),se.clone().toLinear());b=r.divide(r.symfunction(T,[r.divide(Se,r.symfunction(U,[te.clone()]))]),be)}else K.integration.stop();else K.integration.stop();else if(.5===re&&se.power.equals(2)&&ae.greaterThan(0))K.integration.stop();else if(se.isLinear()&&se.group!==v)b=r.divide(K.integration.poly_integrate(X),ae);else{if(se.power.equals(2)&&ae.greaterThan(0)){var qe,Ue,Me,xe,Le,ke;qe=r.parse(U+u(ae)),Ue=r.parse(U+u(ie)),Me=r.multiply(qe.clone(),Ue.clone()).invert(),xe=r.pow(ie,new o(X.power)),ke=e.Utils.getU(X),De=r.multiply(Me,se.clone().toLinear()),Le=r.parse(T+u(De));var Ce=2*(Math.abs(X.power)-1),Ne=K.integrate(r.parse(x+u(ke)+"^"+Ce));return e.Utils.clearU(ke),r.multiply(Ne.sub(ke,Le),xe)}if(X.group===w||X.power.lessThan(0)){fe=X.clone().toLinear();var _e=e.Algebra.Factor.factor(fe).toString()!==fe.toString();if(e.Algebra.degree(fe,r.parse(Z)).equals(2)&&!_e)try{var Fe,Te,Ae;Ae=e.Algebra.sqComplete(fe,Z),De=e.Utils.getU(fe),Fe=Ae.f.sub(Ae.a,De),Te=r.pow(Fe,r.parse(X.power)),b=K.integrate(Te,De).sub(De,Ae.a)}catch(et){K.integration.stop()}else b=K.integration.partial_fraction(X,Z,m,g)}else b=K.integration.by_parts(X,Z,m,g)}b.multiplier=b.multiplier.multiply(ee)}else if(Y===s){var Ee=X.args[0];ee=X.multiplier.clone();X.toUnitMultiplier();ae=(Er=K.integration.decompose_arg(Ee,Z))[0],se=Er[1];var Ie=X.fname;if(Ie===S||Ie===_||Ie===F||Ie===T&&se.isLinear()){re=X.power.toString();if(p(re)&&(m-=re),Ee.isComposite()){var De=e.Utils.getU(X),Pe=(fe=r.pow(r.parse(S+u(De)),new o(re)),K.diff(Ee,Z)),Re=r.multiply(fe,Pe);Ne=K.integrate(Re,De,m,g);b=r.multiply(r.parse(ee),Ne.sub(De,Ee))}else b=r.multiply(r.parse(ee),K.integration.by_parts(X,Z,m,g))}else{if(Ie===L&&X.power.lessThan(0))return(Hr=X.clone()).power.negate(),Hr.fname=N,r.multiply(r.parse(ee),K.integrate(Hr,Z,m));if(!ae.contains(Z,!0)&&X.isLinear())if(Ie===q){if((se=r.divide(Ee.clone(),ae.clone())).group!==h||se.power.lessThan(0))K.integration.stop();else if(e.Utils.even(se.power))b=K.integrate(Ee,Z,m);else{var Ve=K.integrate(se,Z,m);Ve.power=Ve.power.subtract(new t(1)),b=r.multiply(r.multiply(r.symfunction(q,[se.toLinear()]),Ve),ae)}}else{var Oe=X.args[0].group,Ge=K.integration.decompose_arg(Ee,Z);switch((Oe!==d&&Oe!==h&&Oe!==w||!Ge[1].power.equals(1)||Ee.hasFunc())&&K.integration.stop(),Ie){case x:b=r.symfunction(M,[Ee]);break;case M:(b=r.symfunction(x,[Ee])).negate();break;case L:b=r.parse(f(n.LOG+"(sec({0}))",Ee));break;case k:b=r.parse(f(n.LOG+"(tan({0})+sec({0}))",Ee));break;case C:b=r.parse(f("-"+n.LOG+"(csc({0})+cot({0}))",Ee));break;case N:b=r.parse(f(n.LOG+"(sin({0}))",Ee));break;case D:b=r.symfunction(P,[Ee]);break;case P:b=r.symfunction(D,[Ee]);break;case R:b=r.parse(f(n.LOG+"(cosh({0}))",Ee));break;case A:case E:case I:case z:case B:case j:b=K.integration.by_parts(X,Z,m,g);break;case O:b=r.parse(f("atan(sinh({0}))",Ee));break;case V:b=r.parse(f(n.LOG+"(tanh(({0})/2))",Ee));break;case G:b=r.parse(f(n.LOG+"(sinh({0}))",Ee));break;case"exp":b=K.integrate(r.parse(f("e^({0})",Ee)),Z,m);break;case"S":Ee=X.args[0].clone();var ze=(Or=K.integration.decompose_arg(Ee,Z))[1],Be=Or[0],je=Or[3];b=r.parse(f("(cos((1/2)*pi*(({1})+({0})*({2}))^2)+pi*(({1})+({0})*({2}))*S(({1})+({0})*({2})))/(({0})*pi)",Be,je,se));break;case"C":Ee=X.args[0].clone(),ze=(Or=K.integration.decompose_arg(Ee,Z))[1],Be=Or[0],je=Or[3];b=r.parse(f("(pi*(({1})+({0})*({2}))*C(({1})+({0})*({2}))-sin((1/2)*pi*(({1})+({0})*({2}))^2))/(({0})*pi)",Be,je,ze));break;case"erf":Ee=X.args[0].clone(),ze=(Or=K.integration.decompose_arg(Ee,Z))[1],Be=Or[0];b=r.parse(f("e^(-(({2}))^2)/(({0})*sqrt(pi))+(1/({0})+({1}))*erf(({2}))",Be,ze,Ee));break;case"sign":b=r.multiply(X.clone(),Ee.clone());break;default:K.integration.stop()}b=r.divide(b,ae)}else if(se.isLinear()){if(Ie===x||Ie===M)if((re=Number(X.power))<0)X.fname=Ie===M?C:k,X.invert().updateHash(),b=K.integrate(X,Z,m);else{Ee=X.args[0];var He=X.clone(),Qe=X.clone(),Ze=new o((re-1)/re),Xe=r.multiply(ae.clone(),new o(re)).invert();He.power=He.power.subtract(new t(1)),Qe.power=Qe.power.subtract(new t(2));var Ye=r.symfunction(Ie===x?M:x,[Ee.clone()]);Ie===M&&Ye.negate(),b=r.add(r.multiply(r.multiply(Xe,He),Ye),r.multiply(Ze,K.integrate(r.parse(Qe),Z,m)))}else if(Ie===L||Ie===N){if(X.args[0].isLinear(Z)){Ce=X.power.subtract(new t(1)).toString();var Je=X.clone().toUnitMultiplier(),Ke=r.parse(f((Ie===N?"-":"")+"1/({2}*{0})*{3}({1})^({0})",Ce,Ee,ae,Ie));Je.power=Je.power.subtract(new t(2)),Je.power.equals(0)&&(Je=r.parse(Je)),b=r.subtract(Ke,K.integrate(Je,Z,m))}}else if(Ie===k||Ie===C){var We=X.power.subtract(new t(1)).toString(),$e=X.power.subtract(new t(2)).toString(),er=Ie===k?L:N,rr=(Je=X.clone().toUnitMultiplier(),f((Ie===C?"-":"")+"1/({0}*{1})*{4}({3})^({2})*{5}({3})",ae,We,$e,Ee,Ie,er));Ke=r.parse(rr);Je.power=Je.power.subtract(new t(2)),Je.power.equals(0)&&(Je=r.parse(Je)),b=r.add(Ke,r.multiply(new o($e/We),K.integrate(Je,Z,m)))}else Ie!==P&&Ie!==D||!X.power.equals(2)?K.integration.stop():b=K.integrate(X.fnTransform(),Z,m)}else K.integration.stop();b.multiplier=b.multiplier.multiply(ee)}}else if(Y===v)b=K.integration.partial_fraction(X,Z,m);else if(Y===w){X.getDenom().group===h&&(X=r.expand(X));var tr=X.stripVar(Z),ir=r.divide(X.clone(),tr.clone());if(tr.contains(Z)&&(ir=r.multiply(ir,tr),tr=new o(1)),ir.group!==w){if(ir.equals(1))return K.integrate(r.expand(X),Z,m);ir.clone().toLinear().isPoly(!0)&&e.Utils.variables(ir).length>1&&(ir=e.Algebra.Factor.factor(ir)),b=K.integrate(ir,Z,m)}else{var nr=ir.collectSymbols().sort(function(e,r){return e.group===r.group?Number(e.power)===Number(r.power)?e<r?1:-1:r.power-e.power:r.group-e.group}).map(function(e){var t=o.unwrapSQRT(e,!0);return"exp"===t.fname?r.parse(f("({1})*e^({0})",t.args[0],t.multiplier)):t}),ar=nr.length;if(X.power<0){if(2===ar)return K.integrate(r.expand(X),Z,m,g)}else if(2===ar){try{b=K.integration.u_substitution(nr,Z)}catch(et){}if(!b){var sr=nr[0].group,or=nr[1].group,lr=nr[0],ur=nr[1],pr=lr.fname,fr=ur.fname;if(X=r.multiply(lr.clone(),ur.clone()),sr===s&&or===s)if(pr===S||fr===S)b=K.integration.by_parts(X.clone(),Z,m,g);else{nr.sort(function(e,r){return r.fname>e.fname});var cr=lr.args[0];(!cr.isLinear()||cr.group!==d&&cr.group!==w&&cr.group!==h)&&K.integration.stop(),se=(Er=K.integration.decompose_arg(cr,Z))[1],ae=Er[0],se.isLinear()||K.integration.stop();var mr=ur.args[0];if(cr.equals(mr))if(pr===M&&fr===x||pr===x&&fr===M)if(lr.power.lessThan(0)&&K.integration.stop(),pr===M&&lr.power.add(ur.power).equals(0))lr.fname=L,lr.updateHash(),b=K.integrate(lr,Z,m);else if(c(lr.power)&&fr===x&&ur.power.lessThan(0)){Ce=Number(lr.power)/2;var gr=r.parse(f("(1-cos({0})^2)^({1})",lr.args[0],Ce));b=K.integrate(r.expand(r.multiply(gr,ur.clone())),Z,m,g)}else if(c(lr.power)&&fr===M&&ur.power.lessThan(0)){Ce=Number(lr.power)/2,gr=r.parse(f("(1-sin({0})^2)^({1})",lr.args[0],Ce));b=K.integrate(r.expand(r.multiply(gr,ur.clone())),Z,m,g)}else{var hr=e.Utils.even(lr.power),vr=e.Utils.even(ur.power);if(b=new o(0),hr&&vr){var dr=function(e){var t,i=e.power/2;return t=e.fname===x?"((1/2)+(cos(2*("+e.args[0]+"))/2))^"+i:"((1/2)-(cos(2*("+e.args[0]+"))/2))^"+i,r.parse(t)};ae=dr(lr),ie=dr(ur),Ye=r.multiply(ae,ie);return(Hr=r.expand(Ye)).each(function(e){b=r.add(b,K.integrate(e,Z,m))}),r.multiply(b,tr)}hr?(De=lr,Je=ur):(De=ur,Je=lr);var wr=De.fname===x?-1:1,yr=((Ce=Je.power)-1)/2,br=r.parse("(1-"+De.fname+e.Utils.inBrackets(cr)+"^2)^"+yr);(Hr=r.expand(r.multiply(new o(wr),r.multiply(De.clone(),br)))).each(function(e){b=r.add(b,K.integration.poly_integrate(e.clone()))})}else if(pr===k&&fr===L&&se.isLinear()&&ur.isLinear())b=r.parse(f("sec({0})^({1})/({1})",lr.args[0],lr.power));else if(pr===L&&fr===k&&se.isLinear())if(lr.isLinear()&&ur.isLinear())b=r.divide(r.symfunction(k,[cr.clone()]),ae);else if(c(lr.power)){re=Number(lr.power)/2,Ye=r.parse(f("(sec({0})^2-1)^({1})",lr.args[0],re));b=K.integrate(r.expand(r.multiply(Ye,ur)),Z,m)}else K.integration.stop();else if(pr===k&&fr===x)lr.fname=x,lr.invert().updateHash(),b=K.integrate(r.multiply(lr,ur),Z,m);else if(pr===M&&fr===C)ur.fname=M,ur.invert().updateHash(),b=K.integrate(r.multiply(lr,ur),Z,m);else if(pr!==L||fr!==x&&fr!==M||!ur.power.lessThan(0)){Ye=r.multiply(lr.fnTransform(),ur.fnTransform());b=K.integrate(r.expand(Ye),Z,m)}else{var Ye=r.multiply(lr.fnTransform(),ur);b=K.integrate(r.expand(Ye),Z,m)}else if(pr!==M&&pr!==x||fr!==M&&fr!==x)K.integration.stop();else if(lr.isLinear()&&ur.isLinear())if(lr.args[0].isLinear()&&ur.args[0].isLinear()){fr===M?(ne=lr.args[0],Gr=ur.args[0]):(Gr=lr.args[0],ne=ur.args[0]),fe=r.parse(f("(sin(({1})+({0}))+sin(({1})-({0})))/2",ne.toString(),Gr.toString())),b=K.integrate(fe,Z,m)}else{var Sr=J(nr);b=K.integrate(r.expand(Sr),Z,m)}else{Sr=new o(1);nr.map(function(e){var t=e.fnTransform();Sr=r.multiply(Sr,t)});Ye=r.expand(Sr);(b=K.integrate(Ye,Z,m)).hasIntegral()&&(b=K.integrate(J(Sr.collectSymbols()),Z,m))}}else if(sr===s&&or===h){var qr=lr.isLinear();if(lr.fname===x&&qr&&ur.power.equals(-1))b=r.symfunction("Ci",[lr.args[0]]);else if(lr.fname===x&&ur.power.equals(-1))b=K.integrate(r.multiply(lr.fnTransform(),ur.clone()),Z,m);else if(lr.fname===P&&qr&&ur.power.equals(-1))b=r.symfunction("Chi",[lr.args[0]]);else if(lr.fname===P&&ur.power.equals(-1))b=K.integrate(r.multiply(lr.fnTransform(),ur.clone()),Z,m);else if(lr.fname===M&&qr&&ur.power.equals(-1))b=r.symfunction("Si",[lr.args[0]]);else if(lr.fname===M&&ur.power.equals(-1))b=K.integrate(r.multiply(lr.fnTransform(),ur.clone()),Z,m);else if(lr.fname===D&&qr&&ur.power.equals(-1))b=r.symfunction("Shi",[lr.args[0]]);else if(lr.fname===D&&ur.power.equals(-1))b=K.integrate(r.multiply(lr.fnTransform(),ur.clone()),Z,m);else if(lr.fname===S&&ur.power.equals(-1))b=K.integration.poly_integrate(lr,Z,m);else if("erf"===lr.fname){if(ur.power.equals(1)){Be=(Or=K.integration.decompose_arg(lr.args[0],Z))[0],ze=Or[1],Ee=lr.args[0].toString();b=r.parse(f("(e^(-(({2}))^2)*(sqrt(pi)*e^((({2}))^2)*(2*({0})^2*({1})^2-3)*erf(({2}))+2*({0})*({1})-2))/(4*sqrt(pi)*({0})^2)",Be,ze,Ee))}}else b=K.integration.by_parts(X,Z,m,g)}else if(sr===y&&or===h){se=pr===S?K.integration.decompose_arg(lr.args[0],Z)[1]:null;b=lr.isE()&&(lr.power.group===h||lr.power.group===w)&&ur.power.equals(-1)?r.symfunction("Ei",[lr.power.clone()]):pr===S&&se.value===ur.value?K.integration.poly_integrate(lr,Z,m):K.integration.by_parts(X,Z,m,g)}else if(sr===v&&or===h){if(ur.value===lr.value&&lr.power.equals(-1)){var Ur=Math.min.apply(null,e.Utils.keys(lr.symbols)),Mr=Math.min(Ur,ur.power),xr=ur.clone();xr.power=new t(Mr),ur=r.divide(ur,xr.clone());Ye=new o(0);lr.each(function(e){Ye=r.add(Ye,r.divide(e.clone(),xr.clone()))}),Ye.multiplier=lr.multiplier,X=r.divide(ur,Ye)}else X=r.expand(X);b=K.integration.partial_fraction(X,Z,m)}else if(sr===d&&or===h){fe=lr.clone().toLinear();var Lr=e.Algebra.degree(fe,r.parse(Z)).equals(1);if(lr.power.equals(-.5)){ae=(Er=K.integration.decompose_arg(lr.clone().toLinear(),Z))[0].negate(),se=Er[1],ie=Er[3];var kr=Number(lr.power),Cr=Number(ur.power);if(p(Cr)&&e.Utils.even(Cr)&&se.power.equals(2)){var Nr=r.divide(r.multiply(r.pow(ie.clone(),new o(2)),r.symfunction(U,[r.divide(ie.clone(),ae.clone())])),r.pow(ae.clone(),new o(2)));Nr=r.multiply(Nr,r.symfunction(U,[ie]).invert());var _r=r.parse("sin(u)");_r.power=_r.power.multiply(ur.power);Ne=K.integrate(_r,"u",m);var Fr=r.parse(_+"("+U+"("+ae+"/"+ie+")*"+Z+")");b=r.multiply(Nr,Ne.sub(new o("u"),Fr))}else if(-.5===kr){var Tr=function(e,t){var i=r.parse(K.integrate(e,Z,m,g).sub(Z,f(t,Z)));if(!i.hasIntegral())return i};-1===Cr?b=Tr(r.expand(r.expand(r.pow(r.multiply(lr.invert(),ur.invert()),new o(2)))).invert(),"sqrt(1-1/({0})^2)"):-2===Cr&&(b=Tr(r.sqrt(r.expand(r.divide(r.pow(X,new o(2)).invert(),r.pow(new o(Z),new o(2))).negate())).invert(),"sqrt(1-1/({0})^2)"))}}else if(lr.power.equals(-1)&&ur.isLinear()&&Lr)b=K.integration.partial_fraction(X,Z,m);else if(!lr.power.lessThan(0)&&p(lr.power)){var Ar=r.expand(lr);b=new o(0),Ar.each(function(e){e.group===v?e.each(function(e){b=r.add(b,K.integrate(r.multiply(ur.clone(),e),Z,m))}):b=r.add(b,K.integrate(r.multiply(ur.clone(),e),Z,m))})}else if(lr.power.lessThan(-2))b=K.integration.by_parts(X,Z,m,g);else if(lr.power.lessThan(0)&&ur.power.greaterThan(1)){var Er;ae=(Er=K.integration.decompose_arg(lr.clone().toLinear(),Z))[0].negate(),se=Er[1],ie=Er[3],te=lr.clone().toLinear();if(se.group!==v&&se.isLinear()){re=Number(ur.power),De=new o(Pe="_u_");var Ir=r.expand(r.divide(r.pow(r.subtract(De.clone(),ie.clone()),new o(re)),De.clone())),Dr={};Dr[Pe]=te;var Pr=r.parse(Ir,Dr);b=K.integrate(Pr,Z,0)}else if(ur.power.greaterThan(se.power)||ur.power.equals(se.power)){var Rr=new e.Algebra.Classes.Factors;lr=e.Algebra.Factor.coeffFactor(lr.invert(),Rr);var Vr=e.Algebra.divide(ur,lr);Vr.group!==w?(b=new o(0),Vr.each(function(e){b=r.add(b,K.integrate(e,Z,m))}),Rr.each(function(e){b=r.divide(b,e)}),b=r.expand(b)):b=K.integration.by_parts(X,Z,m,g)}else b=K.integration.partial_fraction(X,Z,m)}else if(lr.power.den.equals(2)){ae=(Or=K.integration.decompose_arg(lr.clone().toLinear(),Z))[3],se=Or[1],ie=Or[0];var Or,Gr=Or[2];if(se.power.equals(2)&&ie.lessThan(0)){ae.equals(1)||(tr=r.multiply(tr,r.pow(ae,new o(2))));De=Z,Nr=r.divide(r.pow(ie.clone().negate(),new o(.5)),r.pow(ae,new o(.5))),Pe=r.symfunction(x,[new o(De)]);var zr=r.pow(r.symfunction(x,[new o(De)]),new o(lr.power.num)),Br=r.pow(r.symfunction(M,[new o(De)]),new o(ur.power)),jr=r.multiply(r.multiply(zr,Pe),Br);Ne=K.integrate(jr,De,m);b=Ne.sub(De,r.symfunction(_,[r.multiply(new o(Z),Nr)]))}else b=K.integration.partial_fraction(X,Z,m,g)}else Lr&&(b=K.integration.partial_fraction(X,Z,m))}else if(lr.isComposite()&&ur.isComposite())if(b=new o(0),lr.power.greaterThan(0)&&ur.power.greaterThan(0)){var Hr;(Hr=r.expand(X)).each(function(e){b=r.add(b,K.integrate(e,Z,m))},!0)}else{kr=Number(lr.power),Cr=Number(ur.power);if(kr<0&&Cr>0){Ye=lr;lr=ur,ur=Ye}-1===kr&&-1===Cr?b=K.integration.partial_fraction(X,Z):lr.each(function(e){var t=r.multiply(e,ur.clone()),i=K.integrate(t,Z,m);b=r.add(b,i)})}else if(sr===d&&nr[0].power.greaterThan(0))lr=r.expand(lr),b=new o(0),lr.each(function(e){b=r.add(b,K.integrate(r.multiply(e,ur.clone()),Z,m))},!0);else if(sr===s&&or===y&&e.Utils.in_htrig(lr.fname))lr=lr.fnTransform(),b=K.integrate(r.expand(r.multiply(lr,ur)),Z,m);else if(sr===s&&or===d||or===s&&sr===d){if(or===s&&sr===d){Ye=lr;lr=ur,ur=Ye}var Qr,Zr,Xr;if(Pe=o.unwrapSQRT(K.diff(lr.clone(),Z),!0),Qr=o.unwrapSQRT(ur,!0),Pe.power.equals(Qr.power)){if(re=new o(ur.power),Zr=Pe.clone().toLinear(),Xr=ur.clone().toLinear(),(Ze=e.Algebra.divide(Zr.toLinear(),Xr)).isConstant()){var Yr=r.pow(Ze,re.negate());b=r.multiply(Yr,K.integration.poly_integrate(lr.clone()))}}else b=K.integration.by_parts(X,Z,m,g)}else{var Jr=lr.clone().toLinear(),Kr=ur.clone().toLinear();b=sr===y&&or===y&&lr.power.contains(Z)&&ur.power.contains(Z)&&!Jr.contains(Z)&&!Kr.contains(Z)?r.parse(f("(({0})^(({2})*({4}))*({1})^(({3})*({4})))/(log(({0})^({2}))+log(({1})^({3})))",Jr.toString(),Kr.toString(),lr.power.multiplier.toString(),ur.power.multiplier.toString(),Z)):K.integration.by_parts(X,Z,m,g)}}}else if(3===ar&&(nr[2].group===h&&nr[2].power.lessThan(2)||nr[0].group===d)){var Wr=nr[0];if(Wr.group===d){Wr.power.greaterThan(1)&&(Wr=r.expand(Wr));Je=r.multiply(nr[1],nr[2]);b=new o(0),Wr.each(function(e){var t=r.multiply(e,Je.clone()),i=K.integrate(t,Z,m);b=r.add(b,i)},!0)}else b=K.integration.by_parts(X,Z,m,g)}else if(Q(nr)){Ye=new o(1);var $r=0;for(ar=nr.length;$r<ar;$r++)Ye=r.multiply(Ye,nr[$r].fnTransform());Ye=r.expand(Ye),b=K.integrate(Ye,Z,m)}else{Sr=J(nr);b=K.integrate(r.expand(Sr),Z,m)}}b=r.multiply(b,tr)}}else b=r.multiply(X.clone(),r.parse(Z));if(b)return b}catch(rt){if(!(rt instanceof H||rt instanceof e.exceptions.DivisionByZero))throw rt}return r.symfunction("integrate",[i,l])},!1))},defint:function(t,i,n,a){a=a||"x";var s,l,u=function(e,t,i){try{return r.parse(e,t)}catch(n){return K.Limit.limit(e,a,i)}},p=e.Utils.variables(t),f=t.hasTrig();if(1!==p.length||a||(a=p[0]),f||(l=K.integrate(t,a)),f||l.hasIntegral())if(1===p.length&&i.isConstant()&&n.isConstant()){var c=e.Utils.build(t);s=new o(e.Math2.num_integrate(c,Number(i),Number(n)))}else s=r.symfunction("defint",[t,i,n,a]);else{var m,g,h={},v={};h[a]=n,v[a]=i,m=u(l,h,n),g=u(l,v,i),s=r.subtract(m,g)}return s},Limit:{interval:function(e,t){return r.parse(f("[{0}, {1}]",e,t))},diverges:function(){return K.Limit.interval("-Infinity","Infinity")},divide:function(t,i,a,s,l){if(!(l++>n.max_lim_depth)){t.clone();var u=i.clone();if(i.fname===q){var p=t.sign(),f=s.sign();if(s.isInfinity)return r.multiply(new o(p),new o(f));if(s.equals(0)){var c=r.parse(t.multiplier),g=r.parse(i.multiplier);return r.divide(r.multiply(c,K.Limit.interval("-1","1")),g)}K.Limit.diverges()}var h=function(r){if(e.Utils.isVector(r)){for(var t=0;t<r.elements.length;t++)if(!r.elements[t].isInfinity)return!1;return!0}return r.isInfinity},v=function(r,t){return!e.Utils.isVector(r)&&r.equals(t)};do{var d=m(K.Limit.limit(t.clone(),a,s,l)),w=m(K.Limit.limit(i.clone(),a,s,l)),y=h(d)&&h(w)||v(d,0)&&v(w,0);if(y){var b=K.diff(t.clone(),a),S=K.diff(i.clone(),a),U=r.expand(r.divide(b,S));t=U.getNum(),i=U.getDenom()}}while(y);var M=w.equals(0),x=Number(u.power);return s.isConstant(!0)&&M?o.infinity(e.Utils.even(x)&&d.lessThan(0)?-1:void 0):M?K.Limit.diverges():r.divide(d,w)}},rewriteToLog:function(e){var t=e.power.clone();return e.toLinear(),r.pow(new o("e"),r.multiply(t,r.symfunction(n.LOG+"",[e])))},getSubbed:function(e,r,t){var i;e.group===y&&(e=K.rewriteToLog(e));try{i=e.sub(r,t)}catch(n){i=e}return i},isInterval:function(r){return e.Utils.isVector(r)},isConvergent:function(e){return!(K.Limit.isInterval(e)&&e.elements[0].isInfinity&&e.elements[1].isInfinity||e.containsFunction("limit"))},limit:function(t,i,a,l){if(t.isLinear()&&t.isComposite()){var u=new o(0);return t.each(function(e){u=r.add(u,K.Limit.limit(e,i,a,l))},!0),u}if(t=e.Algebra.Simplify.simplify(t),l=l||1,!(l++>n.max_lim_depth)){var p=r.parse(t.multiplier);t.toUnitMultiplier();try{var c;if(t.isConstant(!0))c=t;else{var g={};g[i]=a;try{var v=r.parse(t.sub(i,a),g);(v.isConstant(!0)||v.isInfinity)&&(c=v)}catch(W){}if(!c){var d=t.getNum(),b=t.getDenom();if(b.isConstant(!0)){if(t.group===y){var q=t.clone().toLinear(),U=(t.power.clone(),q.getNum()),k=q.getDenom(),C=e.Utils.decompose_fn(k,i,!0);if(U.group===h&&U.multiplier.isOne()&&C.ax.group===h&&C.b.isConstant(!0)&&C.a.isOne()&&C.b.isConstant(!0))c=r.parse(f("(1/e^({0}))",C.b));else{var N=K.Limit.rewriteToLog(t.clone()),_=N.power.clone(),F=N.clone().toLinear(),T=K.Limit.limit(F,i,a,l),A=K.Limit.limit(_,i,a,l);c=r.pow(T,A)}}else if(t.group===s&&1===t.args.length){var E,I=K.Limit.limit(t.args[0],i,a,l);if(e.Utils.isVector(I))return c=I.map(function(e){return t.clone().args[0]=e,K.Limit.limit(r.symfunction(t.fname,[e]),i,a,l)}),r.multiply(p,c);if(I.isConstant(!0)){var D=r.symfunction(t.fname,[I]);try{m(D),E=!0}catch(W){E=!1}}if(E)c=D;else if(K.Limit.isConvergent(I))if(t.fname===S)switch(I.toString()){case"0":c=o.infinity().negate();break;case"Infinity":case"-Infinity":c=o.infinity()}else if(t.fname!==x&&t.fname!==M||!a.isInfinity){if(t.fname===L){var P=t.args[0],R=P.getNum(),V=P.getDenom(),O=R.toUnitMultiplier();(a.isInfinity||O.equals("pi")&&V.equals(2))&&(c=divergent())}else if(t.fname===n.FACTORIAL&&I.isInfinity)return o.infinity()}else c=K.Limit.interval(-1,1)}else if(t.group===h){if(t.power>0)return r.parse(t,g);c=e.Utils.even(t.power)?o.infinity():K.Limit.diverges()}else if(t.group===w){var G,z;q=(H=t.collectSymbols().sort(function(e,r){return e.group-r.group})).pop();for(G=m(K.Limit.limit(q,i,a,l));H.length;){var B=H.pop();z=m(K.Limit.limit(B,i,a,l)),G.isInfinity||!K.Limit.isConvergent(G)&&z.equals(0)||G.equals(0)&&K.Limit.isConvergent(z)?(B.containsFunction(S)&&(B=[q,q=B][0]),B.invert(),G=G.isInfinity&&z.isInfinity?o.infinity():K.Limit.divide(q,B,i,a,l)):(G=r.multiply(G,z),q=r.multiply(q,B))}c=G}else if(t.isComposite()){var j;t.isLinear()||(t=r.expand(t)),c=new o(0);for(var H=t.collectSymbols().sort(function(e,r){return r.group-e.group}),Q=[],Z=new o(0),X=0,Y=H.length;X<Y;X++){(J=H[X].clone()).group===s||J.group===w&&J.hasFunc()?Z=r.add(Z,J):Q.push(J)}Q.unshift(Z),1!==Q.length&&(H=Q);for(X=0,Y=H.length;X<Y;X++){var J=H[X];try{j=K.Limit.limit(J,i,a,l)}catch(W){j=K.Limit.diverges()}try{c=r.add(c,j)}catch(W){if(l++>n.max_lim_depth)return;c=K.Limit.limit(K.diff(t,i),i,a,l)}}}}else c=K.Limit.divide(d,b,i,a,l)}}c||(c=r.symfunction("limit",[t,i,a]))}catch(W){c=r.symfunction("limit",[t,i,a])}return r.multiply(p,c)}}},Fresnel:{S:function(e){return e.isConstant(!0)?K.defint(r.parse("sin(pi*x^2/2)"),o(0),e,"x"):r.symfunction("S",arguments)},C:function(e){return e.isConstant(!0)?K.defint(r.parse("cos(pi*x^2/2)"),o(0),e,"x"):r.symfunction("C",arguments)}}};i.register([{name:"diff",visible:!0,numargs:[1,3],build:function(){return K.diff}},{name:"sum",visible:!0,numargs:4,build:function(){return K.sum}},{name:"product",visible:!0,numargs:4,build:function(){return K.product}},{name:"integrate",visible:!0,numargs:[1,2],build:function(){return K.integrate}},{name:"defint",visible:!0,numargs:[3,4],build:function(){return K.defint}},{name:"S",visible:!0,numargs:1,build:function(){return K.Fresnel.S}},{name:"C",visible:!0,numargs:1,build:function(){return K.Fresnel.C}},{name:"limit",visible:!0,numargs:[3,4],build:function(){return K.Limit.limit}}]),i.updateAPI()}()},778:(e,r,t)=>{var i=t(417);t(708),function(){"use strict";var e=i.getCore(),r=e.PARSER,t=e.groups.N,n=e.groups.P,a=e.groups.S,s=e.groups.EX,o=e.groups.FN,l=e.groups.PL,u=e.groups.CP,p=e.groups.CB,f=e.Utils.keys,c=e.Utils.even,m=e.Utils.variables,g=e.Utils.format,h=e.Utils.round,v=e.Frac,d=e.Utils.isInt,w=e.Symbol,y=e.Settings.CONST_HASH,b=e.Utils.importFunctions();e.Utils.evaluate;function S(t,i,n){if(e.Utils.isSymbol(t))this.parse(t),this.variable=this.variable||i;else if(isNaN(t))"string"===typeof t&&this.parse(r.parse(t));else{if(n=n||0,void 0===i)throw new e.exceptions.InvalidVariableNameError("Polynomial expects a variable name when creating using order");this.coeffs=[],this.coeffs[n]=t,this.fill(t)}}function q(){this.factors={},this.length=0}function U(r,t,i){this.terms=t||[],this.coeff=r,this.map=i,this.sum=new e.Frac(0),this.image=void 0}S.fromArray=function(r,t){if("undefined"===typeof t)throw new e.exceptions.InvalidVariableNameError("A variable name must be specified when creating polynomial from array");var i=new S;return i.coeffs=r,i.variable=t,i},S.fit=function(e,r,t,i,n,a){var s=new Array(n+1),o=t-r;s[0]=r,s[n]=e,o-=e*Math.pow(i,n);for(var l=n-1;l>0;l--){var u=Math.pow(i,l),p=o/u,f=Math.sign(p)*Math.floor(Math.abs(p));o-=f*u,s[l]=f}if(0!==o)return null;for(l=0;l<s.length;l++)s[l]=new v(s[l]);return S.fromArray(s,a)},S.prototype={parse:function(i,n){if(this.variable=m(i)[0],!i.isPoly())throw e.exceptions.NerdamerTypeError("Polynomial Expected! Received "+e.Utils.text(i));if(n=n||[],i.power.absEquals(1)||(i=r.expand(i)),i.group===e.groups.N)n[0]=i.multiplier;else if(i.group===e.groups.S)n[i.power.toDecimal()]=i.multiplier;else for(var a in i.symbols){var s=i.symbols[a],o=s.power;if(e.Utils.isSymbol(o))throw new e.exceptions.NerdamerTypeError("power cannot be a Symbol");o=s.group===t?0:o.toDecimal(),s.symbols?this.parse(s,n):n[o]=s.multiplier}this.coeffs=n,this.fill()},fill:function(e){e=Number(e)||0;for(var r=this.coeffs.length,t=0;t<r;t++)void 0===this.coeffs[t]&&(this.coeffs[t]=new v(e));return this},trim:function(){for(var e=this.coeffs.length;e--;){var r=this.coeffs[e],t=r.equals(0);if(!r||!t)break;if(0===e)break;this.coeffs.pop()}return this},modP:function(e){for(var r=this.coeffs.length,t=0;t<r;t++){var i=this.coeffs[t];if(i<0){for(var n,a=t;a<r;a++)if(this.coeffs[a]>0){n=this.coeffs[a];break}if(n){for(;a>t;a--)this.coeffs[a]=this.coeffs[a].subtract(new v(1)),this.coeffs[a-1]=this.coeffs[a-1].add(new v(e));i=this.coeffs[t]}}var s=i.mod(e),o=i.subtract(s).divide(e);if(!o.equals(0)){var l=t+1,u=this.coeffs[l]||new v(0);u=u.add(o),this.coeffs[l]=new v(u),this.coeffs[t]=new v(s)}}return this},add:function(e){for(var r=Math.max(this.coeffs.length,e.coeffs.length),t=0;t<r;t++){var i=this.coeffs[t]||new v(0),n=e.coeffs[t]||new v(0);this.coeffs[t]=i.add(n)}return this},subtract:function(e){for(var r=Math.max(this.coeffs.length,e.coeffs.length),t=0;t<r;t++){var i=this.coeffs[t]||new v(0),n=e.coeffs[t]||new v(0);this.coeffs[t]=i.subtract(n)}return this},divide:function(r){for(var t=this.variable,i=e.Utils.arrayClone(this.coeffs),n=e.Utils.arrayClone(r.coeffs),a=i.length,s=n.length-1,o=[],l=0;l<a;l++){var u=a-(l+1),p=u-s,f=i[u].divide(n[s]);if(p<0)break;o[p]=f;for(var c=0;c<=s;c++)i[c+p]=i[c+p].subtract(n[c].multiply(f))}var m=S.fromArray(i,t||"x").trim();return[S.fromArray(o,t||"x"),m]},multiply:function(e){for(var r=this.coeffs.length,t=e.coeffs.length,i=[],n=0;n<r;n++)for(var a=this.coeffs[n],s=0;s<t;s++){var o=n+s,l=e.coeffs[s],u=i[o]||new v(0);i[o]=u.add(a.multiply(l))}return this.coeffs=i,this},isZero:function(){for(var e=this.coeffs.length,r=0;r<e;r++){if(!this.coeffs[r].equals(0))return!1}return!0},sub:function(e){for(var r=new v(0),t=this.coeffs.length,i=0;i<t;i++){var n=this.coeffs[i];n.equals(0)||(r=r.add(n.multiply(new v(Math.pow(e,i)))))}return r},clone:function(){var e=new S;return e.coeffs=this.coeffs,e.variable=this.variable,e},deg:function(){return this.trim(),this.coeffs.length-1},lc:function(){return this.coeffs[this.deg()].clone()},monic:function(){for(var e=this.lc(),r=this.coeffs.length,t=0;t<r;t++)this.coeffs[t]=this.coeffs[t].divide(e);return this},gcd:function(r){if(this.coeffs.length-1<r.coeffs.length-1)return r.gcd(this);for(var t=this;!r.isZero();){var i=r.clone();r=(t=t.clone()).divide(i)[1],t=i}var n=e.Math2.QGCD.apply(null,t.coeffs);if(!n.equals(1))for(var a=t.coeffs.length,s=0;s<a;s++)t.coeffs[s]=t.coeffs[s].divide(n);return t},diff:function(){for(var e=[],r=this.coeffs.length,t=1;t<r;t++)e.push(this.coeffs[t].multiply(new v(t)));return this.coeffs=e,this},integrate:function(){for(var e=[0],r=this.coeffs.length,t=0;t<r;t++){var i=new v(t+1);e[i]=this.coeffs[t].divide(i)}return this.coeffs=e,this},gcf:function(r){for(var t=[],i=0;i<this.coeffs.length;i++){var n=this.coeffs[i];n.equals(0)||-1!==t.indexOf(n)||t.push(n)}var a=[e.Math2.QGCD.apply(void 0,t),function(e){for(var r=0;r<e.length;r++)if(!e[r].equals(0))return r}(this.coeffs)].toDecimal();if(r){var s=[];s[a[1]-1]=a[0],a=S.fromArray(s,this.variable).fill()}return a},quad:function(e){var r=[];if(this.coeffs.length>3)throw new Error("Cannot calculate quadratic order of "+(this.coeffs.length-1));if(0===this.coeffs.length)throw new Error("Polynomial array has no terms");var t=this.coeffs[2]||0,i=this.coeffs[1]||0,n=i*i-4*t*this.coeffs[0];return n<0&&!e||(r[0]=(-i+Math.sqrt(n))/(2*t),r[1]=(-i-Math.sqrt(n))/(2*t)),r},squareFree:function(){for(var e=this.clone(),r=1,t=e.clone().diff(),i=e.clone().gcd(t),n=e.divide(i)[0],a=S.fromArray([new v(1)],e.variable);!i.equalsNumber(1);){var s=n.gcd(i),o=n.divide(s)[0];if(!o.equalsNumber(1)&&r>1){for(var l=o.clone(),u=1;u<r;u++)l.multiply(o.clone());o=l}a=a.multiply(o),r++,n=s,i=i.divide(s)[0]}return[a,n,r]},toSymbol:function(){var t=this.coeffs.length,i=this.variable;if(0===t)return new e.Symbol(0);for(var n=t-1,a="",s=0;s<t;s++){var o=s===n?"":"+",l=this.coeffs[s];l.equals(0)||(a+=l+"*"+i+"^"+s+o)}return r.parse(a)},equalsNumber:function(e){return this.trim(),1===this.coeffs.length&&this.coeffs[0].toDecimal()===String(e)},toString:function(){return this.toSymbol().toString()}},w.prototype.coeffs=function(e,t){t&&!this.isPoly(!0)&&r.error("Polynomial expected when requesting coefficients with order"),e=e||[];var i=this.clone().distributeMultiplier();if(i.isComposite())for(var n in i.symbols){var a=i.symbols[n];a.isComposite()?a.clone().distributeMultiplier().coeffs(e,t):t?e[a.isConstant()?0:a.power.toDecimal()]=a.multiplier:e.push(a.multiplier)}else if(t)e[i.isConstant(!0)?0:i.power.toDecimal()]=i.multiplier;else if(i.group===p&&i.isImaginary()){var s=new w(i.multiplier);i.each(function(e){(e.isConstant(!0)||e.imaginary)&&(s=r.multiply(s,e))}),e.push(s)}else e.push(i.multiplier);if(t)for(var o=0;o<e.length;o++)void 0===e[o]&&(e[o]=new w(0));return e},w.prototype.tBase=function(e){if("undefined"===typeof e)throw new Error("Symbol.tBase requires a map object!");for(var r=[],t=this.collectSymbols(null,null,null,!0),i=t.length,n=0;n<i;n++){var a=t[n],s=a.group,o=new U(a.multiplier,[],e);if(s===p)for(var l in a.symbols){var u=a.symbols[l];o.terms[e[l]]=u.power}else o.terms[e[a.value]]=a.power;r.push(o.fill()),o.updateCount()}return r},w.prototype.altVar=function(e){var r=this.multiplier.toString(),t=this.power.toString();return("1"===r?"":r+"*")+e+("1"===t?"":"^"+t)},w.prototype.sameVars=function(e){if(!this.symbols&&this.group!==e.group)return!1;for(var r in this.symbols){var t=this.symbols[r],i=e.symbols[r];if(!i)return!1;if(t.value!==i.value)return!1}return!0},w.prototype.groupTerms=function(t){var i,n,a;t=String(t);var s=[];return this.each(function(o){if(o.group===l){a=o.groupTerms(t);for(var u=0;u<a.length;u++){var p=a[u];p&&(s[u]=p)}}else i=e.Utils.decompose_fn(o,t,!0),n=i.x.value===t?Number(i.x.power):0,s[n]=r.add(s[n]||new w(0),i.a)}),s},w.prototype.collectFactors=function(){var e=[];return this.group===p?this.each(function(r){e.push(r.clone())}):e.push(this.clone()),e},q.prototype.getNumberSymbolics=function(){var e=0;return this.each(function(r){r.isConstant(!0)||e++}),e},q.prototype.add=function(t){if(t.equals(0))return this;if(t.equals(-1)&&this.length>0){var i=e.Utils.firstObject(this.factors,null,!0);return this.add(r.symfunction(e.Settings.PARENTHESIS,[i.obj]).negate()),delete this.factors[i.key],this.length--,this}if(t.group===p){var n=this;t.multiplier.equals(1)||n.add(new w(t.multiplier)),t.each(function(e){n.add(e)})}else{this.preAdd&&(t=this.preAdd(t)),this.pFactor&&(t=r.pow(t,new w(this.pFactor)));var a=t.isConstant();if(a&&t.equals(1))return this;var s=a?t.value:t.text();s in this.factors?(this.factors[s]=r.multiply(this.factors[s],t),this.factors[s].equals(1)&&(delete this.factors[s],this.length--)):(this.factors[s]=t,this.length++)}return this},q.prototype.toSymbol=function(){for(var t=new w(1),i=Object.values(this.factors).sort(function(e,r){return e.group>r.group}),n=0,a=i.length;n<a;n++){var s=i[n],o=s.power.equals(1)&&""!==s.fname?r.symfunction(e.PARENTHESIS,[s]):s;t=r.multiply(t,o)}return""===t.fname&&(t=w.unwrapPARENS(t)),t},q.prototype.merge=function(e){for(var t in e)t in this.factors?this.factors[t]=r.multiply(this.factors[t],e[t]):this.factors[t]=e[t];return this},q.prototype.each=function(r){for(var t in this.factors){var i=this.factors[t];i.fname===e.PARENTHESIS&&i.isLinear()&&(i=i.args[0]),r.call(this,i,t)}return this},q.prototype.count=function(){return f(this.factors).length},q.prototype.clean=function(){try{var r=e.Settings.CONST_HASH;this.factors[r].lessThan(0)&&(this.factors[r].equals(-1)?delete this.factors[r]:this.factors[r].negate(),this.each(function(e){e.negate()}))}catch(t){}},q.prototype.toString=function(){return this.toSymbol().toString()},U.prototype.updateCount=function(){this.count=this.count||0;for(var e=0;e<this.terms.length;e++)this.terms[e].equals(0)||this.count++;return this},U.prototype.getVars=function(){for(var e=[],r=0;r<this.terms.length;r++){var t=this.terms[r];this.getRevMap();t.equals(0)||e.push(this.rev_map[r])}return e.join(" ")},U.prototype.len=function(){return"undefined"===typeof this.count&&this.updateCount(),this.count},U.prototype.toSymbol=function(e){e=e||this.getRevMap();for(var t=new w(this.coeff),i=0;i<this.terms.length;i++){var n=e[i],a=this.terms[i];if(!a.equals(0)&&n!==y){var s=new w(n);s.power=a,t=r.multiply(t,s)}}return t},U.prototype.getRevMap=function(){if(this.rev_map)return this.rev_map;var e={};for(var r in this.map)e[this.map[r]]=r;return this.rev_map=e,e},U.prototype.generateImage=function(){return this.image=this.terms.join(" "),this},U.prototype.getImg=function(){return this.image||this.generateImage(),this.image},U.prototype.fill=function(){for(var r=this.map.length,t=0;t<r;t++)"undefined"===typeof this.terms[t]?this.terms[t]=new e.Frac(0):this.sum=this.sum.add(this.terms[t]);return this},U.prototype.divide=function(e){for(var r=this.coeff.divide(e.coeff),t=this.terms.length,i=new U(r,[],this.map),n=0;n<t;n++)i.terms[n]=this.terms[n].subtract(e.terms[n]),i.sum=i.sum.add(i.terms[n]);return i},U.prototype.multiply=function(e){for(var r=this.coeff.multiply(e.coeff),t=this.terms.length,i=new U(r,[],this.map),n=0;n<t;n++)i.terms[n]=this.terms[n].add(e.terms[n]),i.sum=i.sum.add(i.terms[n]);return i},U.prototype.isZero=function(){return this.coeff.equals(0)},U.prototype.toString=function(){return"{ coeff: "+this.coeff.toString()+", terms: ["+this.terms.join(",")+"]: sum: "+this.sum.toString()+", count: "+this.count+"}"},e.Utils.toMapObj=function(e){for(var r=0,t={},i=0;i<e.length;i++){var n=e[i];"undefined"===typeof t[n]&&(t[n]=r,r++)}return t.length=r,t},e.Utils.filledArray=function(e,r,t){for(var i=[];r--;)i[r]=t?new t(e):e;return i},e.Utils.arrSum=function(e){for(var r=0,t=e.length,i=0;i<t;i++)r+=e[i];return r},e.Utils.haveIntersection=function(e,r){var t;return r.length>e.length&&(t=r,r=e,e=t),e.some(function(e){return r.indexOf(e)>-1})},e.Utils.subFunctions=function(r,t){t=t||{};var i=[];return r.each(function(r){if(r.group===o||r.previousGroup===o){var n=e.Utils.text(r,"hash"),a=t[n];if(a)i.push(r.altVar(a));else{var s=r.fname+f(t).length;t[n]=s,i.push(r.altVar(s))}}else r.group===p||r.group===l||r.group===u?i.push(e.Utils.subFunctions(r,t)):i.push(r.text())}),r.group===u||r.group===l?r.altVar(e.Utils.inBrackets(i.join("+"))):r.group===p?r.altVar(e.Utils.inBrackets(i.join("*"))):r.text()},e.Utils.getFunctionsSubs=function(e){var t={};for(var i in e)t[e[i]]=r.parse(i);return t};var M=e.Algebra={version:"1.4.6",proots:function(t,i){i=i||7;var n=[],s=function(e,r,t){for(var i=N(e,r,t).concat(n),a=0;a<0;a++)i.unshift(0);return i};if(t instanceof w&&t.isPoly()){if(t.distributeMultiplier(),t.group===l){var o=e.Utils.arrayMin(f(t.symbols)),u=t.symbols[o].clone().toUnitMultiplier();t=r.expand(r.divide(t,u)),n.push(0)}if(t.group===e.groups.S)return[0];if(t.group===e.groups.PL){var p=f(t.symbols),c=e.Utils.arrayMin(p);t=e.PARSER.divide(t,e.PARSER.parse(t.value+"^"+c))}for(var m=f(t.symbols).sort().pop(),g=t.group===e.groups.PL?t.symbols:t.symbols[m],v=g.group,d=(p=v===a?[g.power.toDecimal()]:f(g.symbols),[]),b=e.Utils.arrayMax(p),S=1;S<=b;S++){var q=0;-1!==p.indexOf(S+"")&&(q=v===a?g.multiplier:g.symbols[S].multiplier),d.unshift(q)}return d.push(t.symbols[y].multiplier),g.group===a&&(d[0]=g.multiplier),s(d,p,b)}if(e.Utils.isArray(t)){var U=t,M=(d=[],p=[],0);for(S=0;S<U.length;S++){for(var x=U[S][0],L=U[S][1],k=L-M-1,C=0;C<k;C++)d.unshift(0);d.unshift(x),0!==L&&p.push(L),M=L}return s(d,p,b=Math.max.apply(void 0,p))}throw new e.exceptions.NerdamerTypeError("Cannot calculate roots. Symbol must be a polynomial!");function N(r,t,n){var a=r.slice(0);if(r.unshift(n),n>100)throw new e.exceptions.ValueLimitExceededError("This utility accepts polynomials of degree up to 100. ");var s=[],o={};for(o.Degree=n,S=0;S<n;S++)s.push(0);var l=s.slice(0);function u(e,r,t,i,n,a){n[0]=a.b=i[0],n[1]=a.a=-r*a.b+i[1];for(var s=2;s<e;s++)n[s]=-(r*a.a+t*a.b)+i[s],a.b=a.a,a.a=n[s]}function p(e,r,t,i,n,a,s,o,l){var p=new Object,f=3;return p.b=p.a=0,u(r,s,o,a,l,p),n.c=p.a,n.d=p.b,Math.abs(n.c)<=100*e*Math.abs(a[r-1])&&Math.abs(n.d)<=100*e*Math.abs(a[r-2])||(n.h=o*i,Math.abs(n.d)>=Math.abs(n.c)?(f=2,n.e=t/n.d,n.f=n.c/n.d,n.g=s*i,n.a3=n.e*(n.g+t)+n.h*(i/n.d),n.a1=-t+n.f*i,n.a7=n.h+(n.f+s)*t):(f=1,n.e=t/n.c,n.f=n.d/n.c,n.g=n.e*s,n.a3=n.e*t+(n.g+n.h/n.c)*i,n.a1=-t*(n.d/n.c)+i,n.a7=n.g*n.d+n.h*n.f+t)),f}function f(e,r,t,i,n,a,s,o,l){var u;if(3!=t)if(u=1==t?n:i,Math.abs(a.a1)>10*e*Math.abs(u)){a.a7/=a.a1,a.a3/=a.a1,s[0]=l[0],s[1]=-l[0]*a.a7+l[1];for(p=2;p<r;p++)s[p]=-l[p-1]*a.a7+o[p-2]*a.a3+l[p]}else{s[0]=0,s[1]=-l[0]*a.a7;for(p=2;p<r;p++)s[p]=-l[p-1]*a.a7+o[p-2]*a.a3}else{s[1]=s[0]=0;for(var p=2;p<r;p++)s[p]=o[p-2]}}function c(e,r,t,i,n,a,s,o,l,u,p,f,c,m,g,h,v){var d,w,y,b,S,q,U,M;r.b=r.a=0,3!=e&&(2!=e?(d=t+c*s+f*u,w=o+(c+m*u)*l):(d=(t+p)*u+f,w=(u+c)*o+m*l),0!=(M=-(U=-((S=(y=-g[h-1]/v[h])*a)+(q=y*y*n))+m*(b=-(g[h-2]+y*v[h-1])/v[h])*i)+w+y*d)&&(r.a=-(c*(q+S)+m*(y*i+b*a))/M+c,r.b=m*(1+U/M)))}function m(e,r,t,i){var n,a,s;i.sr=i.si=i.lr=i.li=0,0!=e?0!=t?(n=r/2,Math.abs(n)<Math.abs(t)?(s=-(s=t>=0?e:-e)+n*(n/Math.abs(t)),a=Math.sqrt(Math.abs(s))*Math.sqrt(Math.abs(t))):(s=-e/n*(t/n)+1,a=Math.sqrt(Math.abs(s))*Math.abs(n)),s>=0?(a=n>=0?-a:a,i.lr=(-n+a)/e,i.sr=0!=i.lr?t/i.lr/e:i.sr):(i.lr=i.sr=-n/e,i.si=Math.abs(a/e),i.li=-i.si)):i.lr=-r/e:i.sr=0!=r?-t/r:i.sr}function g(e,r,t,i,n,a,s,o,l,g,h,v){var d,w,y,b,S,q,U,M,x,L,k,C=new Object,N=0,_=0;t.NZ=0,q=i,M=n;do{if(C.li=C.lr=C.si=C.sr=0,m(1,q,M,C),t.szr=C.sr,t.szi=C.si,t.lzr=C.lr,t.lzi=C.li,Math.abs(Math.abs(t.szr)-Math.abs(t.lzr))>.01*Math.abs(t.lzr))break;for(u(s,q,M,l,a,o),w=Math.abs(-t.szr*o.b+o.a)+Math.abs(t.szi*o.b),L=Math.sqrt(Math.abs(M)),d=2*Math.abs(a[0]),S=-t.szr*o.b,k=1;k<r;k++)d=d*L+Math.abs(a[k]);if(w<=20*(d=(9*(d=d*L+Math.abs(S+o.a))+2*Math.abs(S)-7*(Math.abs(o.a+S)+L*Math.abs(o.b)))*e)){t.NZ=2;break}if(++N>20)break;if(N>=2&&b<=.01&&w>=y&&!_){for(u(s,q-=q*(b=b<e?Math.sqrt(e):Math.sqrt(b)),M+=M*b,l,a,o),k=0;k<5;k++)f(e,r,p(e,r,o.a,o.b,h,v,q,M,g),o.a,o.b,h,v,g,a);_=1,N=0}y=w,f(e,r,p(e,r,o.a,o.b,h,v,q,M,g),o.a,o.b,h,v,g,a),c(p(e,r,o.a,o.b,h,v,q,M,g),o,o.a,h.a1,h.a3,h.a7,o.b,h.c,h.d,h.f,h.g,h.h,q,M,v,r,l),U=o.a,0!=(x=o.b)&&(b=Math.abs((-M+x)/x),q=U,M=x)}while(0!=x)}function v(e,r,t,i,n,a,s,o,l){var u,p,f,c,m,g,h,v,d,w,y,b=i-1;for(r.NZ=y=d=0,h=t.a;;){for(g=n[0],s[0]=g,w=1;w<a;w++)s[w]=g=g*h+n[w];for(f=Math.abs(g),c=Math.abs(h),u=.5*Math.abs(s[0]),w=1;w<a;w++)u=u*c+Math.abs(s[w]);if(f<=20*e*(2*u-f)){r.NZ=1,r.szr=h,r.szi=0;break}if(++y>10)break;if(y>=2&&Math.abs(v)<=.001*Math.abs(-v+h)&&f>m){d=1,r.a=h;break}for(m=f,l[0]=p=o[0],w=1;w<i;w++)l[w]=p=p*h+o[w];if(Math.abs(p)>10*Math.abs(o[b])*e)for(v=-g/p,o[0]=s[0],w=1;w<i;w++)o[w]=v*l[w-1]+s[w];else for(o[0]=0,w=1;w<i;w++)o[w]=l[w-1];for(p=o[0],w=1;w<i;w++)p=p*h+o[w];h+=v=Math.abs(p)>10*Math.abs(o[b])*e?-g/p:0}return d}function d(e,r,t,i,n,a,s,o,l,m,h,d){var w,y,b,S,q,U,M,x,L,k,C,N,_,F,T,A,E,I,D,P,R,V,O,G,z,B=new Object,j=new Object,H=new Array(r),Q=new Array(r),Z=1;for(d.NZ=0,S=b=.25,q=i,x=n,B.b=B.a=0,u(l,h,n,o,m,B),w=B.a,y=B.b,j.h=j.g=j.f=j.e=j.d=j.c=j.a7=j.a3=j.a1=0,O=p(e,s,w,y,j,a,h,n,H),P=0;P<t;P++){if(I=1,f(e,s,O,w,y,j,a,H,m),c(O=p(e,s,w,y,j,a,h,n,H),B,w,j.a1,j.a3,j.a7,y,j.c,j.d,j.f,j.g,j.h,h,n,a,s,o),T=B.a,E=A=B.b,k=0!=a[s-1]?-o[s]/a[s-1]:0,C=_=1,0!=P&&3!=O&&(G=(F=(_=0!=E?Math.abs((E-x)/E):_)<M?_*M:1)<S?1:0,(R=(N=(C=0!=k?Math.abs((k-q)/k):C)<U?C*U:1)<b?1:0)||G)){for(D=0;D<s;D++)Q[D]=a[D];for(L=k,V=z=0;;){if(I&&0==(I=0)&&R&&(!G||N<F));else{if(g(e,s,d,T,A,m,l,B,o,H,j,a),w=B.a,y=B.b,d.NZ>0)return;if(Z=z=1,S*=.25,V||!R)Z=0;else for(D=0;D<s;D++)a[D]=Q[D]}if(0!=Z){if(B.a=L,Z=v(e,d,B,s,o,l,m,a,H),L=B.a,d.NZ>0)return;if(V=1,b*=.25,0!=Z){T=-(L+L),A=L*L;continue}}for(D=0;D<s;D++)a[D]=Q[D];if(!G||z)break}u(l,h,n,o,m,B),O=p(e,s,w=B.a,y=B.b,j,a,h,n,H)}x=E,q=k,M=_,U=C}}!function(e,r,t,i){var n,a,s,o,l,u,p,f,c,g,h,v,w,y,b,S,q,U,M,x,L,k,C,N=e.Degree,_=.017453292519943295,F=Math.LN2,T=e.Degree+1,A=new Array(T),E=new Array(T),I=new Array(T),D=new Array(T),P=new Object,R=new Object;v=1;do{a=v,w=1+(v/=2)}while(w>1);var V=Number.MIN_VALUE/a,O=Math.cos(94*_),G=Math.sin(94*_),z=Math.sqrt(.5),B=-z;for(R.NZ=U=0,R.szr=R.szi=R.lzr=R.lzi=0;0==r[N];)t[U]=i[U]=0,N--,U++;for(k=N+1;N>=1;){if(N<=2){N<2?(t[e.Degree-1]=-r[1]/r[0],i[e.Degree-1]=0):(P.li=P.lr=P.si=P.sr=0,m(r[0],r[1],r[2],P),t[e.Degree-2]=P.sr,i[e.Degree-2]=P.si,t[e.Degree-1]=P.lr,i[e.Degree-1]=P.li);break}for(p=0,f=Number.MAX_VALUE,j=0;j<k;j++)(g=Math.abs(r[j]))>p&&(p=g),0!=g&&g<f&&(f=g);if(((c=V/f)<=1&&p>=10||c>1&&Number.MAX_VALUE/c>=p)&&(c=0==c?Number.MIN_VALUE:c,x=Math.floor(Math.log(c)/F+.5),1!=(l=Math.pow(2,x))))for(j=0;j<k;j++)r[j]*=l;for(var j=0;j<k;j++)E[j]=Math.abs(r[j]);E[N]=-E[N],L=N-1,g=Math.exp((Math.log(-E[N])-Math.log(E[0]))/N),0!=E[L]&&(g=(h=-E[N]/E[L])<g?h:g),h=g;do{h=.1*(g=h),u=E[0];for(j=1;j<k;j++)u=u*h+E[j]}while(u>0);o=g;do{s=u=E[0];for(j=1;j<N;j++)s=g*s+(u=g*u+E[j]);g-=o=(u=g*u+E[N])/s}while(Math.abs(o/g)>.005);n=g;for(j=1;j<N;j++)A[j]=(N-j)*r[j]/N;for(A[0]=r[0],v=r[N],w=r[L],C=0==A[L]?1:0,M=0;M<5;M++)if(y=A[L],C){for(j=0;j<L;j++)A[U=L-j]=A[U-1];A[0]=0,C=0==A[L]?1:0}else{S=-v/y;for(j=0;j<L;j++)A[U=L-j]=S*A[U-1]+r[U];A[0]=r[0],C=Math.abs(A[L])<=Math.abs(w)*a*10?1:0}for(j=0;j<N;j++)D[j]=A[j];for(M=1;M<=20;M++){if(q=-G*B+O*z,B=G*z+O*B,d(a,T,20*M,b=n*(z=q),n,A,N,r,k,I,-2*b,R),0!=R.NZ){t[U=e.Degree-N]=R.szr,i[U]=R.szi,N=(k-=R.NZ)-1;for(j=0;j<k;j++)r[j]=I[j];1!=R.NZ&&(t[U+1]=R.lzr,i[U+1]=R.lzi);break}for(j=0;j<N;j++)A[j]=D[j]}if(M>20){e.Degree-=N;break}}}(o,a,l,s);var w=s.length;for(S=0;S<w;S++){var y=h(s[S],i+8),b=h(l[S],i+8),q=y<0?"-":"";0===(b=i-String(b).length>2?b:l[S])&&(b=""),0===y&&(y=""),y=1===Math.abs(y)?q+"i":y?y+"*i":"";var U=b&&y?b+"+"+y:b+y;l[S]=U.replace(/\+\-/g,"-")}return l}},roots:function(t){if(t.isConstant(!0,!0))return e.Utils.nroots(t);var i=M.proots(t).map(function(e){return r.parse(e)});return e.Vector.fromArray(i)},froot:function(r,t,i){return function(t){for(var n=i||e.Utils.build(e.Calculus.diff(r.clone())),a=r instanceof Function?r:e.Utils.build(r),s=!1,o=0;!s;){var l=t-a(t)/n(t),u=Math.abs(l)-Math.abs(t);t=l,Math.abs(u)<1e-12?s=!0:o>1e4&&(t=null,s=!0),o++}return t}(Number(t))},quad:function(e,t,i){var n=function(e,t,i,n){return r.parse("-("+t+"+"+n+"*sqrt(("+t+")^2-4*("+e+")*("+i+")))/(2*"+e+")")};return[n(e,t,i,1),n(e,t,i,-1)]},sumProd:function(e,r){return M.quad(-r,e,-1).map(function(e){return e.invert()})},coeffs:function(e,t,i){t=String(t),e=r.expand(e),i=i||[new w(0)],e.group===s&&e.contains(t,!0)&&r.error("Unable to get coefficients using expression "+e.toString());var n=m(e);if(1!==n.length||n[0]!==t||e.isImaginary())if(t||r.error("Polynomial contains more than one variable. Please specify which variable is to be used!"),-1===n.indexOf(t))i[0]=r.add(e,i[0]);else if(i=i||[new w(0)],e.group===p){var a=e.symbols[t];a||r.error("Expression is not a polynomial!");var o=Number(a.power);((h=r.divide(e.clone(),a.clone())).contains(t,!0)||o<0||!d(o))&&r.error("Expression is not a polynomial!"),(g=i[o])&&(h=r.add(g,h)),i[o]=h}else e.group===u&&e.each(function(e){M.coeffs(e.clone(),t,i)},!0);else for(var l=new S(e).coeffs.map(function(e){return new w(e)}),f=0,c=l.length;f<c;f++){var g,h=l[f];(g=i[f])&&(h=r.add(g,h)),i[f]=h}for(f=0,c=i.length;f<c;f++)"undefined"===typeof i[f]&&(i[f]=new w(0));return i},polyPowers:function(r,i,n){if(n=n||[],(c=c=r.group)===l&&i===r.value)n=n.concat(f(r.symbols));else if(c===u)for(var s in r.symbols){var o=r.symbols[s],c=o.group,m=o.value;if(c===a&&i===m)n.push(o.power);else if(c===l||c===u)n=M.polyPowers(o,i,n);else if(c===p&&o.contains(i)){var g=o.symbols[i];g&&n.push(g.power)}else c!==t&&i===m||n.push(0)}else c===p&&r.contains(i)&&n.push(e.Utils.decompose_fn(r,i,!0).x.power);return e.Utils.arrayUnique(n).sort()},Factor:{split:function(e){var t=new w(1),i=new w(1);return M.Factor.factor(e,new q).each(function(e){var n=r.parse(e);e.isConstant(!0)?t=r.multiply(t,n):i=r.multiply(i,n)}),[t,i]},mix:function(e,r){for(var t=f(e),i=t.length,n=[],a=0;a<i;a++){for(var s=t[a],o=e[s],l=n.length,u=0;u<l;u++){var p=n[u]*s;n.push(p),r&&n.push(-p)}for(u=1;u<=o;u++)n.push(Math.pow(s,u))}return n},common:function(t,i){try{if(t.group===u){for(var n=r.expand(t.clone(),!0).collectSymbols(null,null,function(e,r){return(r.length||1)-(e.length||1)}),a={},s=[],o=0;o<n.length;o++){var l=n[o];s.push(l.multiplier.clone()),l.each(function(e){var r=Number(e.power);if(isNaN(r))throw new Error("exiting");e.value in a?(r<a[e.value][0]&&(a[e.value][0]=r),a[e.value][1].push(e)):a[e.value]=[r,[e]]})}var p=new w(1);for(var f in a)a[f][1].length===n.length&&(p=r.multiply(p,r.pow(new w(f),new w(a[f][0]))));var c=e.Math2.QGCD.apply(null,s);if(!c.equals(1)){i.add(new w(c));for(o=0;o<n.length;o++)n[o].multiplier=n[o].multiplier.divide(c)}if(!p.equals(1)){i.add(p),t=new w(0);for(o=0;o<n.length;o++)t=r.add(t,r.divide(n[o],p.clone()))}}}catch(m){}return t},zeroes:function(t,i){var n=function(){throw new e.exceptions.ValueLimitExceededError("Exiting")};try{var a,s,o,l,p;p=(t=r.expand(t.clone())).toString(),a=m(t),o=new w(0);for(var f=[],c=[],g=0,h=a.length;g<a.length;g++){for(var y={},b=0;b<h;b++)g!==b&&(y[a[b]]=0);var S=(s=r.parse(p,y)).power;d(S)||n(),f.push(s),c.push(s.power)}if(e.Utils.allSame(c)){var q=t.length,U=f.length;2===U&&(l=new v(c[0]/(q-1))),3===U&&(l=new v(c[0]/Math.round((Math.sqrt(8*q-1)-3)/2)))}else l=e.Math2.QGCD.apply(null,c);d(l)||n();for(g=0;g<f.length;g++){var x=f[g],L=x.power.clone().divide(l);x.multiplier=new v(Math.pow(x.multiplier,1/L)),x.power=l.clone(),o=r.add(o,x)}if(o.group!==u)return t;for(;;){var k=M.div(t.clone(),o.clone());if(!k[1].equals(0))break;if(t=k[0],i.add(o.clone()),t.equals(1))break}}catch(p){}return t},factor:function(t,i){if(t.isConstant())return e.Math2.factor(t);var n=r.parse(t),a=M.Factor._factor(n,i);if(a.equals(t))return a;if(a.group===p){var s=new w(1),o=r.parse(a.power),l=r.parse(a.multiplier);a.toUnitMultiplier(),a.multiplier.lessThan(0)&&(s.negate(),a.negate()),a.each(function(e){var t=r.parse(M.Factor._factor(e));t.group===p?(l=r.multiply(l,w.create(t.multiplier)),t.each(function(e){var t=r.parse(M.Factor._factor(e));s=r.multiply(s,t),t.group===p&&(l=r.multiply(l,w.create(t.multiplier)))})):s=r.multiply(s,t)}),a=r.pow(r.multiply(l,s),o)}return a},quadFactor:function(t,i){if(t.isPoly()&&M.degree(t.equals(2))){var n=e.Utils.variables(t)[0],a=M.coeffs(t,n),s=M.Factor._factor(a[2].clone());if(s.group===p){var o=s.collectSymbols();if(o.length>2)return t;var l=r.multiply(r.parse(a[0]),r.parse(o[0])),u=r.parse(a[1]).negate(),f=r.parse(o[1]),c=M.quad(f,u,l).filter(function(r){if(e.Utils.isInt(r))return r});if(1===c.length){var m=c[0],h=r.divide(a[0],r.parse(m));e.Utils.isInt(h)&&(i.add(r.parse(g("({0})*({1})+({2})",o[1],n,h))),i.add(r.parse(g("({0})*({1})+({2})",o[0],n,m))),t=new w(1))}}}return t},cubeFactor:function(e,t){if(e.isComposite()){var i=e.collectSymbols();if(2===i.length){var n=i[0].sign(),a=i[0].clone().abs(),s=i[1].sign(),o=i[1].clone().abs();if(a.isCube()&&o.isCube()){n<s&&([n,s]=[s,n],[a,o]=[o,a]);var l=r.parse(a.getNth(3)),u=r.parse(o.getNth(3)),p=r.multiply(r.expand(r.pow(a.clone().toUnitMultiplier(),r.parse("1/3"))),l),f=r.multiply(r.expand(r.pow(o.clone().toUnitMultiplier(),r.parse("1/3"))),u);1===n&&-1===s?(t.add(r.parse(g("(({0})-({1}))",p,f))),t.add(r.parse(g("(({0})^2+({0})*({1})+({1})^2)",p,f))),e=w(1)):1===n&&1===s&&(t.add(r.parse(g("(({0})+({1}))",p,f))),t.add(r.parse(g("(({0})^2-({0})*({1})+({1})^2)",p,f))),e=w(1))}}}return e},_factor:function(t,i){t.group;if(t.group===o){var n=t.args[0];if(n.group===a&&n.isSimple())return t}else if(t.group===a&&t.isSimple())return t;if(t.group===u){t.distributeMultiplier(!0);var s=new w(0);t.each(function(e){(e.group===u&&e.power.greaterThan(1)||e.group===p)&&(e=r.expand(e)),s=r.add(s,e)}),s.power=t.power,t=s}t.group===o&&"sqrt"!==t.fname&&(t=e.Utils.evaluate(t));var l=t.clone();try{if(t.group===p){var g,h,v,y,b,S,U=r.parse(t.power);if(g=M.Simplify.strip(t.getDenom()),h=M.Simplify.strip(t.getNum()),v=g.pop(),(y=h.pop()).equals(t))return t;S=M.Factor.factor(y),b=M.Factor.factor(v);var x=M.Simplify.unstrip(h,S),L=M.Simplify.unstrip(g,b);return G=r.divide(x,L)}if(t.group===a)return t;if(t.isConstant())return t.equals(1)?t.clone():e.Math2.factor(t);U=t.power.clone();if(d(U)&&(!U.lessThan(0)||t.group!==o)){var k=U.sign();t.toLinear(),i=i||new q;var C={};t=r.parse(e.Utils.subFunctions(t,C)),f(C).length>0&&(i.preAdd=function(t){return r.parse(t,e.Utils.getFunctionsSubs(C))}),t.isLinear()||(i.pFactor=t.power.toString(),t.toLinear());var N=m(t);t.isImaginary()&&N.push(e.Settings.IMAGINARY);var _=N.length>1;if(_){var F=!0,T=!0;if(t.each(function(e){e.group!==a&&(F=!1),e.multiplier.equals(1)||(T=!1)}),F&&T)return r.pow(r.parse(t,e.Utils.getFunctionsSubs(C)),r.parse(U))}var A=new q;t=M.Factor.coeffFactor(t,A),A.each(function(e){c(U)&&e.lessThan(0)&&e.negate(),k<0&&e.invert(),i.add(e)});var E=new q;if(t=M.Factor.powerFactor(t,E),E.each(function(e){k<0&&e.invert(),i.add(e)}),_)t=M.Factor.cubeFactor(t,i),t=M.Factor.mfactor(t,i),i.each(function(e){k<0&&e.power.negate()});else{var I=N[0];t=M.Factor.squareFree(t,i,I);var D=new q;t=M.Factor.trialAndError(t,D,I);var P=D.toSymbol();if(P.equals(l))return P;for(var R in D.factors){var V=D.factors[R];i.add(r.pow(V,r.parse(U)))}t.equals(l)&&(t=M.Factor.quadFactor(t,i))}t=r.parse(t,e.Utils.getFunctionsSubs(C));var O=1===i.length;i.add(r.pow(t,r.parse(U)));var G=i.toSymbol();return O&&t.equals(1)&&G.isLinear()&&(G=r.pow(G,r.parse(U))),G}return t}catch(z){return l}},reduce:function(e,t){if(e.group===u&&2===e.length){var i=e.collectSymbols().sort(function(e,r){return r.multiplier-e.multiplier});if(i[0].power.equals(i[1].power)){var n=r.parse(i[0].power),a=i[0].clone().toLinear(),s=i[1].clone().toLinear();t.add(r.add(a.clone(),s.clone())),s.negate();for(var o=Number(n),l=new w(0),p=1;p<=o;p++){var f=r.pow(a.clone(),r.subtract(n.clone(),new w(p))),c=r.pow(s.clone(),r.subtract(new w(p),new w(1)));l=r.add(l,r.multiply(f,c))}return l}}return e},squareFree:function(e,r,t){if(e.isConstant()||e.group===a)return e;var i=new S(e,t).squareFree(),n=i[2];if(1!==n){var s=i[1].toSymbol();return s.power=s.power.multiply(new v(n)),r.add(M.Factor.factor(s)),M.Factor.squareFree(i[0].toSymbol(),r)}return e},powerFactor:function(t,i){if(t.group!==l||t.previousGroup===s)return t;var n=f(t.symbols);if(!e.Utils.allNumeric(n))return t;var a=e.Utils.arrayMin(n),o=new w(0),u=r.parse(t.value+"^"+a);return t.each(function(e){e=r.divide(e,u.clone()),o=r.add(o,e)}),i.add(u),o},coeffFactor:function(r,t){if(r.isComposite()){var i=e.Math2.QGCD.apply(null,r.coeffs());if(i.equals(1)){var n=function(e){var r;return e.group===p?(r=0,e.each(function(e){r+=e.power})):r=Number(e.power),r},a=r.collectSymbols(null,null,null,!0).sort(function(e,r){return e.isConstant(!0)?1:r.power-e.power}),s=a[0];(n(s)>n(a[1])||a[1].isConstant(!0))&&s.multiplier.lessThan(0)&&(t.add(new w(-1)),r.each(function(e){e.negate()},!0))}else r.each(function(e){e.isComposite()?e.each(function(e){e.multiplier=e.multiplier.divide(i)}):e.multiplier=e.multiplier.divide(i)}),r.updateHash();t&&t.add(new w(i))}return r},trialAndError:function(r,t,i){var n=r.clone();try{var s=[];if(r.isConstant()||r.group===a)return r;for(var o=new S(r,i),l=o.coeffs[0],u=e.Math2.ifactor(l),p=M.proots(r),f=0;f<p.length;f++){var c=p[f],m=1;if(!isNaN(c)){for(var g in u){var h=e.Utils.round(Math.log(g)/Math.log(Math.abs(c)),8);if(d(h)){c=g,m=h;break}}var w=new v(c),y=[new v(w.num).negate()];y[m]=new v(w.den);var b=S.fromArray(y,o.variable).fill(),q=o.divide(b);q[1].equalsNumber(0)&&(o=q[0],s.push(b.toSymbol()))}}return o.equalsNumber(1)||(o=M.Factor.search(o,t)),s.forEach(function(e){t.add(e)}),o.toSymbol()}catch(U){return n}},search:function(r,t,i){i=i||10;var n=r.variable,a=function(e,a,s,o){var l=S.fit(e,a,s,i,o,n);if(l&&l.coeffs.length>1){var u=r.divide(l);if(u[1].equalsNumber(0))return t.add(l.toSymbol()),[u[0],l]}return null},s=r.coeffs[0],o=e.Math2.ifactor(s),l=r.lc(),u=e.Math2.ifactor(l),p=r.sub(i),f=e.Math2.ifactor(p),c=M.Factor.mix(f,p<0),m=Math.ceil(r.coeffs.length/2),g=l.lessThan(0),h=s.lessThan(0);for(u[1]=1,o[1]=1;m--;)for(var v in u)for(var d in o)for(var w=0;w<c.length;w++){var y=a(v,d,c[w],m);if(y)return r=y[0],e.Utils.isPrime(r.sub(i))||(r=M.Factor.search(r,t)),r;y||(g&&h?y=a(-v,-d,c[w],m):g?y=a(-v,d,c[w],m):h&&(y=a(v,-d,c[w],m)))}return r},mSqfrFactor:function(r,t){if(r.group!==o)for(var i=m(r).reverse(),n=0;n<i.length;n++)do{if(i[n]!==r.value){var a=e.Calculus.diff(r,i[n]),s=M.Factor.coeffFactor(a);if(s.equals(0))break;var l=!0;if(s.isConstant()&&r.isComposite()&&r.each(function(e){e.multiplier%s!==0&&(l=!1)},!0),l){var u=M.div(r,s.clone()),p=u[1].equals(0);if(r.equals(u[0])&&u[1].equals(0))break;if(u[0].isConstant()){t.add(u[0]);break}}else p=!1;p&&(t.add(u[0]),r=s)}else t.add(r),r=new w(1)}while(p);return r},sqdiff:function(t,i){if(t.isConstant("all"))return t;try{var n=function(r){return e.Utils.block("POSITIVE_MULTIPLIERS",function(){return w.unwrapPARENS(b.sqrt(b.abs(r)))},!0)},s=e.Utils.separate(t.clone()),o=[];for(var l in s)"constants"!==l&&o.push(s[l]);if(o.sort(function(e,r){return r.power-e.power}),2===o.length){var u,p;if(u=o.pop(),p=o.pop(),c(u.power)&&c(p.power)&&u.sign()===p.sign()&&u.group===a&&p.group===a)throw new Error("Unable to factor");if(u.isComposite()&&p.power.equals(2)){p=n(p);var f=M.Factor.factor(r.add(u,s.constants));f.power.equals(2)&&(f.toLinear(),i.add(r.subtract(f.clone(),p.clone())),i.add(r.add(f,p)),t=new w(1))}else if(u=u.powSimp(),p=p.powSimp(),(u.group===a||""===u.fname)&&u.power.equals(2)&&(p.group===a||""===p.fname)&&p.power.equals(2)&&!s.constants){if(u.multiplier.lessThan(0)){var m=p;p=u,u=m}u.multiplier.greaterThan(0)&&(u=n(u),p=n(p)),i.add(r.subtract(u.clone(),p.clone())),i.add(r.add(u,p)),t=new w(1)}}}catch(g){}return t},mfactor:function(t,i){if(t.group===o)if("sqrt"===t.fname){var n=new q,a=M.Factor.common(t.args[0].clone(),n);a=M.Factor.coeffFactor(a,n),t=r.multiply(r.symfunction("sqrt",[a]),r.parse(t.multiplier)),n.each(function(i){t=r.multiply(t,r.parse(e.Utils.format("sqrt({0})",i)))})}else i.add(t);else{t=M.Factor.mSqfrFactor(t,i);for(var s=m(t),l=t.collectSymbols().map(function(e){return w.unwrapSQRT(e)}),u={},p={},f=s.length,c=l.length,g=0;g<f;g++){var h=s[g];u[h]=new w(0);for(var v=0;v<c;v++){var y=l[v];if(y.contains(h)){var b=y.value===h?y.power.toDecimal():y.symbols[h].power.toDecimal();(!p[h]||b<p[h])&&(p[h]=b),u[h]=r.add(u[h],y.clone())}}}for(var S in u){var U=r.parse(S+"^"+p[S]),x=r.divide(u[S],U),L=r.expand(x);if(L.equals(1))break;var k=M.div(t.clone(),L);if(k[0].equals(0))break;if(k[1].equals(0)){var C=!1;if(k[0].each(function(e){d(e.multiplier)||(C=!0)}),C){k[1]=r.expand(r.multiply(k[1],L));break}}var N=d(L)&&L.lessThan(0);if(k[1].equals(0)&&!N){var _=M.div(t.clone(),k[0].clone());if((U=_[0]).equals(0))return t;if(t=_[1],U.equals(-1)&&!t.equals(0))return t;var F=k[0];if(t.equals(F)){var T=M.Factor.reduce(F,i);return t.equals(T)?T:M.Factor.mfactor(T,i)}return i.add(F),t.equals(0)?U:U.isConstant("all")?(i.add(U),U):M.Factor.mfactor(U,i)}}}return t=M.Factor.sqdiff(t,i),t=M.Factor.zeroes(t,i)}},allLinear:function(e){for(var r=e.length,t=0;t<r;t++)if(!M.isLinear(e[t]))return!1;return!0},isLinear:function(e){var r=!1,i=e.group;if(i===l||i===u)for(var n in r=!0,e.symbols){var f=e.symbols[n],c=f.group;if(c!==o&&c!==s||(r=!1),c===p)r=1===m(f).length;else if(c===l||c===u)r=M.isLinear(f);else if(f.group!==t&&"1"!==f.power.toString()){r=!1;break}}else i===a&&1===e.power&&(r=!0);return r},gcd:function(){var t;if(0===(t=1===arguments.length&&arguments[0]instanceof e.Vector?arguments[0].elements:e.Utils.arguments2Array(arguments)).length)return new w(1);if(1===t.length)return t[0];for(var i=[],n=!1,a=0;a<t.length;a++)if(t[a].group===o&&"gcd"===t[a].fname)(t=t.concat(arguments[a].args)).splice(a,1);else{var s=m(t[a]);if(e.Utils.haveIntersection(s,i)){n=!0;break}i=i.concat(s)}if(n||0===i.length){if(t.every(function(e){return e.getDenom().equals(1)})){var l=t[0];for(a=1;a<t.length;a++)l=M.gcd_(t[a],l);return l}return r.divide(M.gcd.apply(null,t.map(function(e){return e.getNum()})),M.lcm.apply(null,t.map(function(e){return e.getDenom()})))}return r.symfunction("gcd",t)},gcd_:function(t,i){if(t.group!==o&&t.group!==n||(t=e.Utils.block("PARSE2NUMBER",function(){return r.parse(t)})),i.group===o&&(i=e.Utils.block("PARSE2NUMBER",function(){return r.parse(i)})),t.isConstant()&&i.isConstant())return new w(e.Math2.QGCD(new v(+t),new v(+i)));var a=r.multiply(t.getDenom()||new w(1),i.getDenom()||new w(1)).invert();if(t=r.multiply(t.clone(),a.clone()),i=r.multiply(i.clone(),a.clone()),t=r.expand(t),i=r.expand(i),t.group===p||i.group===p){var l=r.divide(t.clone(),i.clone());if(!(g=r.multiply(i.clone(),l.getDenom().invert())).equals(1))return g}if(t.group===s||i.group===s){var u=new w(e.Math2.GCD(t.multiplier,i.multiplier)),f=M.gcd_(t.value===y?new w(1):r.parse(t.value),i.value===y?new w(1):r.parse(i.value)),c=M.gcd_(r.parse(t.power),r.parse(i.power));return r.multiply(u,r.pow(f,c))}if(t.length<i.length){var g=t;t=i,i=g}var h=m(t),d=m(i);if(h.length===d.length&&1===h.length&&h[0]===d[0]||1===h.length&&0===d.length||0===h.length&&1===d.length)return t=new S(t),i=new S(i),r.divide(t.gcd(i).toSymbol(),a);var b,q=[];for(t.each(function(e){q.push(e.multiplier)}),i.each(function(e){q.push(e.multiplier)});!i.equals(0);){g=i.clone();if(t=t.clone(),b=M.div(t,g),i=b[1],b[0].equals(0))return r.divide(new w(e.Math2.QGCD(t.multiplier,i.multiplier)),a);t=g}var U=e.Math2.QGCD.apply(void 0,q);return U.equals(1)||t.each(function(e){e.multiplier=e.multiplier.divide(U)}),!t.equals(1)||t.isConstant()||i.isConstant()?r.divide(t,a):r.divide(r.symfunction("gcd",arguments),a)},lcm:function(){var t;1===arguments.length?arguments[0]instanceof e.Vector?t=arguments[0].elements:r.error("lcm expects either 1 vector or 2 or more arguments"):t=e.Utils.arguments2Array(arguments);var i,n=t.reduce(function(e,t){return r.multiply(e,t.clone())},new w(1)),a=function(e,r){r=Number(r);var t,i,n,a=[],s=Math.pow(2,e.length);for(i=r;i<s;i++){t=[],n=e.length-1;do{0!==(i&1<<n)&&t.push(e[n])}while(n--);t.length===r&&a.push(t)}return a}(arguments,arguments.length-1).map(function(e){return e.reduce(function(e,t){return r.multiply(e,t.clone())},new w(1))});return i=t.every(function(r){return e.Utils.isVariableSymbol(r)})?r.symfunction("gcd",e.Utils.arrayUnique(a)):M.gcd.apply(null,a),r.divide(n,i)},divide:function(t,i){var n,a,s,o;return(o=(s=e.Algebra.Factor.factor(t.clone())).getDenom()).isConstant("all")?o=new w(1):t=r.expand(w.unwrapPARENS(r.multiply(s,o.clone()))),n=M.div(t,i),a=r.divide(n[1],i),r.divide(r.add(n[0],a),o)},div:function(t,i){var n=[new w(0),t.clone()];try{if(i.isConstant("all"))return t.each(function(e){e.multiplier=e.multiplier.divide(i.multiplier)}),[t,new w(0)];if(t=r.expand(t),i=r.expand(i),t.group===a&&i.group===u){var s=t.value,o=e.Utils.decompose_fn(i.clone(),s,!0);if(t.isLinear()&&o.x&&o.x.isLinear()&&i.isLinear()){var l=w.create(t.multiplier);return[r.divide(l.clone(),o.a.clone()),r.divide(r.multiply(l,o.b),o.a).negate()]}}if(t.group===a&&i.group===a){var p=r.divide(t.clone(),i.clone());return p.isConstant()?[p,new w(0)]:[new w(0),t.clone()]}var f=t.hasFunc(),c=i.hasFunc(),g=!1;if(f||c){g=!0;var h={},d=(t=r.parse(e.Utils.subFunctions(t,h)),i=r.parse(e.Utils.subFunctions(i,h)),e.Utils.getFunctionsSubs(h))}var b,q,M=e.Utils.arrayUnique(m(t).concat(m(i)));if((t.isImaginary()||i.isImaginary())&&M.push(e.Settings.IMAGINARY),1===M.length){b=(X=new S(t).divide(new S(i)))[0].toSymbol(),q=X[1].toSymbol()}else{M.push(y);var x=function(e){for(var t=new w(0),i=0;i<e.length;i++){var n=e[i].toSymbol();t=r.add(t,n)}return t},L=function(e,r){var t,i=Math.max.apply(null,e.terms),n=0;if(!r)for(var a=0;a<e.terms.length;a++)if(e.terms[a].equals(i)&&(t=a,n++),n>1)return;if(r)for(a=0;a<e.terms.length;a++)if(e.terms[a].equals(i)){t=a;break}return[i,t,e]},k=function(e,r){var t=e[r=r||0],i=e.length;if(t){for(var n,a,s=L(t),o=r+1;o<i;o++){var l=e[o],u=t.sum.equals(l.sum);if(!u&&s)break;if(u){for(var p,f,c,m,g=t.terms.length,h=0;h<g;h++){var v=t.terms[h],d=l.terms[h];("undefined"===typeof p||v.greaterThan(p))&&(p=v,c=h),("undefined"===typeof f||d.greaterThan(f))&&(f=d,m=h)}var w=p.subtract(l.terms[c]),y=f.subtract(t.terms[m]);if(y>w){s=[f,m,l];break}if(w>y){s=[p,c,t];break}}else if(s=L(l))break;s=L(l)}if(!s)return L(e[0],!0);for(o=0;o<T.length;o++){var b=T[o].terms;if((a=s[1])===b.length-1)return;if(!(n=b[a]).equals(0))break}return n.equals(0)?k(e,++r):s}},C=e.Utils.toMapObj(M),N=function(e,r){return r.sum.subtract(e.sum)},_=function(e,r){if(!e||!r)return!1;for(var t=0;t<e.terms.length;t++)if(e.terms[t].lessThan(r.terms[t]))return!1;return!0},F=t.tBase(C).sort(N),T=i.tBase(C).sort(N),A=_(F[0],T[0])&&F[0].count>T[0].count?T:F,E=k(A),I=[];if(E){var D=E[1],P=function(e,r){return!e[0].sum.equals(r[0].sum)||e.length>=r.length},R=function(e,r){var t=e.len(),i=r.len(),n=r.terms[D],a=e.terms[D];return i>t&&n.greaterThan(a)?i-t:n.subtract(a)};D=function(e,r,t){for(var i=[],n=0;n<e.length;n++)for(var a=e[n],s=0;s<a.terms.length;s++){var o=i[s],l=a.terms[s];0===n?i[s]=l:o&&!o.equals(l)&&(i[s]=void 0)}for(n=0;n<i.length;n++){if((a=i[n])&&!a.equals(0))return n}return t}(F,0,D),F.sort(R),T.sort(R);var V=T[0],O=F[0],G=new U(new v(1),[],O.map);if(V.sum.greaterThan(O.sum)&&O.len()>1)for(var z=0;z<O.terms.length;z++){var B=V.terms[z].subtract(O.terms[z]);if(B.equals(0))G.terms[z]=new v(0);else{var j=B.add(new v(1));G.terms[z]=B;for(var H=0;H<F.length;H++)F[H].terms[z]=F[H].terms[z].add(j)}}for(var Q=_(F[0],T[0]),Z=0;Q&&P(F,T);){if(Z++>200)throw new e.exceptions.InfiniteLoopError("Unable to compute!");var X=F[0].divide(T[0]);I.push(X),F.shift();for(z=1;z<T.length;z++){var Y=T[z].multiply(X).generateImage(),J=F.length;0===J&&(Y.coeff=Y.coeff.neg(),F.push(Y),F.sort(R));for(H=0;H<J;H++){var K=F[H];if(K.getImg()===Y.getImg()){K.coeff=K.coeff.subtract(Y.coeff),K.coeff.equals(0)&&(e.Utils.remove(F,H),H--);break}H===J-1&&(Y.coeff=Y.coeff.neg(),F.push(Y),F.sort(R))}}if(!(Q=_(F[0],T[0]))&&F.length>=T.length)for(z=1;z<F.length;z++)if(Q=_(F[z],T[0])){F.unshift(e.Utils.remove(F,z));break}}}b=x(I),q=x(F),"undefined"!==typeof G&&(G=G.toSymbol(),b=r.divide(b,G.clone()),q=r.divide(q,G))}return g&&(b=r.parse(b.text(),d),q=r.parse(q.text(),d)),[b,q]}catch(W){return n}},line:function(t,i,n){e.Utils.isArray(t)&&(t=e.Utils.convertToVector(t)),e.Utils.isArray(i)&&(i=e.Utils.convertToVector(i)),n=r.parse(n||"x"),e.Utils.isVector(t)&&e.Utils.isVector(i)||r.error('Line expects a vector! Received "'+t+'" & "'+i+'"');var a=r.subtract(i.e(1).clone(),t.e(1).clone()),s=r.subtract(i.e(2).clone(),t.e(2).clone()),o=r.divide(s,a),l=r.multiply(n,o.clone()),u=r.multiply(t.e(1).clone(),o);return r.add(r.subtract(l,u),t.e(2).clone())},PartFrac:{createTemplate:function(e,t,i,n){var s,l,u,p,f,c,m;(e=M.Factor.factor(e)).each(function(r,t){if(r.group===o&&""===r.fname&&r.args[0].group===a){var i=r.args[0];this.symbols?(delete this.symbols[t],this.symbols[i.value]=i):e=r.args[0]}}),s=t.collectFactors(),l=[],c=[],m=new w(1);for(var g=0;g<s.length;g++){var h=w.unwrapPARENS(s[g]);if(h.power.greaterThan(1)){p=Number(h.power),u=h.clone().toLinear(),f=Number(M.degree(u,n));for(var v=0;v<p;v++){var d=r.pow(u.clone(),new w(v+1));i.push(d.clone());var y=r.divide(e.clone(),d.clone());c.push(f),l.push(y)}}else{f=Number(M.degree(h,n)),i.push(h);y=r.divide(e.clone(),h.clone());y=r.expand(w.unwrapPARENS(y)),c.push(f),l.push(y)}}return[i=i.map(function(e){return r.multiply(e,m.clone())}),l,c]},partfrac:function(t,i,n){var a=m(t);i=i||r.parse(a[0]);try{var s,o,l,u,p,f,c,g,h,v,d,y,b,S,q,U,x,L,k;if(s=r.expand(t.getNum()),o=r.expand(t.getDenom().toUnitMultiplier()),s.multiplier=t.multiplier,p=s.groupTerms(i),Number(M.degree(s,i))>=Number(M.degree(o,i))?(b=(y=M.div(s.clone(),r.expand(o.clone())))[0],p=(s=y[1]).groupTerms(i)):b=new w(0),1===Number(M.degree(o,i))){var C=r.divide(s,o);return n?[b,C]:r.add(b,C)}u=M.Factor.factor(o),U=M.PartFrac.createTemplate(o.clone(),u,[],i),x=U[0],S=U[1],f=U[2],d=[p.length],c=[],l=[],q=[],S.map(function(e,t){L=x[t],k=f[t];for(var n=0;n<k;n++){l.push(L.clone());var a=w.create(i,n),s=r.expand(r.multiply(e,a.clone())).groupTerms(i),o=s.length;d.push(o),c.push(s),q.push(a.clone())}}),g=e.Utils.arrayMax(d),v=new e.Matrix(e.Utils.fillHoles(p,g)).transpose(),h=new e.Matrix;for(var N=0;N<c.length;N++)h.elements.push(e.Utils.fillHoles(c[N],g));var _=r.multiply(h.transpose().invert(),v),F=n?[b]:b;return _.each(function(e,t){var i=r.multiply(q[t],r.divide(e,l[t]));n?F.push(i):F=r.add(F,i)}),F}catch(I){try{if(t.isComposite()){var T={};t.each(function(e){var t=e.getDenom(),i=e.getNum(),n=T[t];T[t]=n?r.add(n,i):i});var A=new w(0);for(var E in T)A=r.add(A,r.divide(T[E],r.parse(E)));t=A}}catch(D){}}return t}},degree:function(t,i,n){if(n=n||{nd:[],sd:[],depth:0},!i){var o=m(t);if(o.length>1)throw new Error("You must specify the variable for multivariate polynomials!");if(0===o.length)return new w(0);i=r.parse(o[0])}var l=t.group;t.isComposite()?((t=t.clone()).distributeExponent(),t.each(function(e){n.depth++,M.degree(e,i,n),n.depth--})):t.group===p?t.each(function(e){n.depth++,M.degree(e,i,n),n.depth++}):l===s&&t.value===i.value?n.sd.push(t.power.clone()):l===a&&t.value===i.value?n.nd.push(r.parse(t.power)):n.nd.push(new w(0));var u=n.nd.length>0?e.Utils.arrayMax(n.nd):void 0;return 0===n.depth&&n.sd.length>0?(void 0!==u&&n.sd.unshift(u),r.symfunction("max",n.sd)):(e.Utils.isSymbol(u)||(u=r.parse(u)),u)},sqComplete:function(t,i,n){e.Utils.isSymbol(i)||(i=r.parse(i));var a,s,o,l,u,p,f,c,m,g,h,v=function(r){throw r=r||"Stopping",new e.exceptions.ValueLimitExceededError(r)};return t.isPoly(!0)||v("Must be a polynomial!"),m=e.Utils.inBrackets,t=t.clone(),(a=e.Algebra.degree(t,i)).equals(2)||v("Cannot complete square for degree "+a),s=(f=e.Algebra.coeffs(t,i))[2],c=f[1].sign(),o=r.divide(f[1],new w(2)),l=r.pow(o.clone(),new w(2)),n?[s,o,u]:(h=b.sqrt(s),p=r.divide(b.sqrt(l),h.clone()),u=r.subtract(f[0],r.pow(p.clone(),new w(2))),{a:g=r.parse(m(h.clone()+"*"+i+(c<0?"-":"+")+p)),c:u,f:r.add(r.pow(g.clone(),new w(2)),u.clone())})},Simplify:{strip:function(e){var t=r.parse(e.multiplier);e.toUnitMultiplier();var i=r.parse(e.power);return e.toLinear(),[t,i,e]},unstrip:function(e,t){var i=e[0],n=e[1];return r.multiply(i,r.pow(t,n))},complexSimp:function(e,t){var i,n,a,s,o,l,u,p,f;return l=e.realpart(),p=e.imagpart(),u=t.realpart(),f=t.imagpart(),i=r.multiply(l.clone(),u.clone()),n=r.multiply(p.clone(),f.clone()),a=r.multiply(u.clone(),p),s=r.multiply(l,f.clone()),o=r.add(r.pow(u,new w(2)),r.pow(f,new w(2))),r.divide(r.add(r.add(i,n),r.multiply(r.subtract(a,s),w.imaginary())),o)},trigSimp:function(t){if(t.containsFunction(["cos","sin","tan"])){t=t.clone();var i=M.Simplify.strip(t),n=(t=i.pop()).clone();if(t.group===u){var a=new w(0);t.each(function(e){var t=M.Simplify.trigSimp(e.fnTransform());a=r.add(a,t)},!0),n=r.pow(r.multiply(new w(t.multiplier),a),new w(t.power))}else if(t.group===p){var s=t.getNum(),o=t.getDenom();if("sin"===s.fname&&"cos"===o.fname&&s.args[0].equals(o.args[0])&&s.power.equals(o.power)&&(n=r.parse(e.Utils.format("({0})*({1})*tan({2})^({3})",o.multiplier,s.multiplier,s.args[0],s.power))),n.group===p){var l=new w(1);n.each(function(t){"tan"===t.fname&&(t=r.parse(e.Utils.format("({0})*sin({1})^({2})/cos({1})^({2})",t.multiplier,M.Simplify.simplify(t.args[0]),t.power))),l=r.multiply(l,t)}),n=l}}t=n=M.Simplify.unstrip(i,n).distributeMultiplier()}return t},fracSimp:function(e){var t=e.getDenom();if((g=e.getNum()).isImaginary()&&t.isImaginary()&&(e=M.Simplify.complexSimp(g,t)),e.isComposite()){e.power>1&&(e=r.expand(e));var i,n,a,s,o,l,u,p,f,c,m,g,h=e.collectSymbols();for(n=h.pop();h.length;)a=h.pop(),s=r.parse(n.getDenom()),o=r.parse(a.getDenom()),l=n.getNum(),u=a.getNum(),m=r.multiply(s.clone(),o.clone()),f=r.multiply(l,o),c=r.multiply(u,s),p=r.add(f,c),n=r.divide(p,m);return t=r.expand(n.getDenom()),(i=(g=r.expand(n.getNum())).isImaginary()&&t.isImaginary()?M.Simplify.complexSimp(g,t):r.divide(g,t)).equals(e)?e:M.Simplify.simplify(i)}return e},ratSimp:function(e){if(e.group===p){var t=e.getDenom(),i=e.getNum().distributeMultiplier(),n=M.Simplify.fracSimp(t),a=M.Simplify.fracSimp(i);e=r.divide(a,n)}return e},sqrtSimp:function(e,i){if(e.isSQRT()){var n,a=M.Factor.factor(e.args[0].clone()),s=r.parse(a.multiplier),o=s.sign(),l=r.sqrt(s.abs());if(d(l)){if(a.group===p){var u=new w(1);a.each(function(e){if(e.group===t){var i=r.sqrt(e.clone());d(i)?l=r.multiply(l,i):u=r.multiply(u,e)}else u=r.multiply(u,e)});var f=r.multiply(u,r.parse(o));(n=r.sqrt(f.clone())).isImaginary&&(n=r.sqrt(r.expand(f.clone())))}else n=r.sqrt(a.clone().toUnitMultiplier());return r.multiply(l,n)}}else e.isComposite()&&e.isLinear()?(l=new w(0),e.each(function(e){l=r.add(l,M.Simplify.sqrtSimp(e))},!0),l=r.multiply(l,r.parse(e.multiplier))):e.group===p&&(l=r.parse(e.multiplier),e.each(function(e){var t=M.Simplify.sqrtSimp(e);l=r.multiply(l,t)},!0),l=r.pow(l,r.parse(e.power)));return l||r.parse(e)},patternSub:function(r){var t={},i=function(e){var r=!1;return e.each(function(e){e.group===u?r=!0:e.symbols&&(r=i(e))}),r},n=function(a){a.each(function(a){if(a.symbols||a.group===o)if(i(a))n(a);else if(!t[a.value]){var s=e.Utils.getU(r);t[a.value]=s,r=r.sub(a.value,s)}},!0)};return n(r),[r,t]},simplify:function(t){var i=M.Simplify.strip(t);if(t=i.pop(),(t=M.Simplify.fracSimp(t)).isConstant()||t.group===e.groups.S)return i.push(t),M.Simplify.unstrip(i,t);var n=t.clone();if(n=M.Simplify.trigSimp(n),n=M.Simplify.ratSimp(n),(n=M.Factor.factor(n)).group===e.groups.CP&&n.isLinear()){var a=n.multiplier.clone();n.toUnitMultiplier();var s=new w(0);n.each(function(e){var t=M.Simplify.simplify(e);s=r.add(s,t)}),n=s,s.multiplier=s.multiplier.multiply(a)}return M.Simplify.unstrip(i,n)}},Classes:{Polynomial:S,Factors:q,MVTerm:U}};e.Expression.prototype.simplify=function(){return M.Simplify.simplify(this.symbol)},i.useAlgebraDiv=function(){var t=M.divideFn=r.divide,i=0;r.divide=function(r,n){var a;return a=1===++i?e.Algebra.divide(r,n):t(r,n),i=0,a}},i.useParserDiv=function(){M.divideFn&&(r.divide=M.divideFn),delete M.divideFn},i.register([{name:"factor",visible:!0,numargs:1,build:function(){return M.Factor.factor}},{name:"simplify",visible:!0,numargs:1,build:function(){return M.Simplify.simplify}},{name:"gcd",visible:!0,numargs:[1],build:function(){return M.gcd}},{name:"lcm",visible:!0,numargs:[1],build:function(){return M.lcm}},{name:"roots",visible:!0,numargs:-1,build:function(){return M.roots}},{name:"divide",visible:!0,numargs:2,build:function(){return M.divide}},{name:"div",visible:!0,numargs:2,build:function(){return M.div}},{name:"partfrac",visible:!0,numargs:[1,2],build:function(){return M.PartFrac.partfrac}},{name:"deg",visible:!0,numargs:[1,2],build:function(){return M.degree}},{name:"coeffs",visible:!0,numargs:[1,2],build:function(){return function(){var r=M.coeffs.apply(M,arguments);return new e.Vector(r)}}},{name:"line",visible:!0,numargs:[2,3],build:function(){return M.line}},{name:"sqcomp",visible:!0,numargs:[1,2],build:function(){return function(e,r){try{return r=r||m(e)[0],M.sqComplete(e.clone(),r).f}catch(t){return e}}}}]),i.updateAPI()}()}}]);
//# sourceMappingURL=151.bb275172.chunk.js.map